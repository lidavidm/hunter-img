<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2017-05-09 Tue 13:52 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Neo-Davidsonian Semantics with Minimalist Grammars</title>
<meta name="generator" content="Org mode">
<meta name="author" content="David Li">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="static/base.css">
<link rel="stylesheet" type="text/css" href="static/mg.css">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<article id="content">
<header>
<h1 class="title">Neo-Davidsonian Semantics with Minimalist Grammars</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org8c4f9bd">1. Logical Forms</a></li>
<li><a href="#orgba488b3">2. Tokenization</a></li>
<li><a href="#org3f1587a">3. Minimalist Grammar</a>
<ul>
<li><a href="#org1ebb4c9">3.1. Features</a>
<ul>
<li><a href="#org67b07a0">3.1.1. Lexicon</a></li>
</ul>
</li>
<li><a href="#orgbb87e17">3.2. Grammar</a></li>
<li><a href="#org6f2592b">3.3. Parsing</a></li>
</ul>
</li>
<li><a href="#org101e11d">4. Examples</a></li>
<li><a href="#org24105a7">5. Bibliography</a></li>
<li><a href="#org90a68a5">6. License</a></li>
</ul>
</div>
</nav>
<p>
This module implements a basic parser for Hunter (2011)'s formulation of Minimalist Grammars. It is based on various parsers and sources, but primarily on Niedzielski (2015)'s Haskell MGA parser and Hunter (2011)'s book.
</p>

<section id="outline-container-org8c4f9bd" class="outline-2">
<h2 id="org8c4f9bd"><span class="section-number-2">1</span> Logical Forms</h2>
<div class="outline-text-2" id="text-1">
<p>
We represent logical forms using a combination of Conjunctivist and Neo-Davidsonian semantics. The former means that instead of having the full first-order logic, we instead have only conjunctions of monadic (1-argument) predicates. This limits our expressiveness, but as we'll see, we don't necessarily need so much power. Neo-Davidsonian semantics seeks to make events first-class entities, allowing them to be modified like any other entity. This makes the meaning of adverbial adjuncts clearer. Here, we integrate the two by adding an existential closure operator <code>Closure</code> (\(\left<\phi\right>\)) to our semantics, which asserts the existence of some event which is modified by the given formula. Also, to simplify implementation of quantifiers, we will make them first-class as well. (In Hunter's formalism, quantifiers are simply another type of monadic predicate with special interpretation. Since they already need special handling, we simply include them as a separate type of logical formula.)
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">quantifier</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Exists</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Forall</span>

<span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">formula</span> <span class="org-tuareg-font-lock-operator">=</span>                      <span class="org-comment-delimiter">(* </span><span class="org-comment">&#8497; </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Constant</span>   <span class="org-keyword">of</span> string            <span class="org-comment-delimiter">(* </span><span class="org-comment">c </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Variable</span>   <span class="org-keyword">of</span> int               <span class="org-comment-delimiter">(* </span><span class="org-comment">x&#8321;, x&#8322;, etc </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Int</span>        <span class="org-keyword">of</span> formula           <span class="org-comment-delimiter">(* </span><span class="org-comment">int(&#966;) </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Inti</span>       <span class="org-keyword">of</span> formula <span class="org-tuareg-font-lock-operator">*</span> int     <span class="org-comment-delimiter">(* </span><span class="org-comment">int&#8321;(&#966;), int&#8322;(&#966;), etc. </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Ext</span>        <span class="org-keyword">of</span> formula           <span class="org-comment-delimiter">(* </span><span class="org-comment">ext(&#966;) </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Conj</span>       <span class="org-keyword">of</span> formula <span class="org-tuareg-font-lock-operator">*</span> formula <span class="org-comment-delimiter">(* </span><span class="org-comment">&#966; &amp; &#968; </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Closure</span>    <span class="org-keyword">of</span> formula           <span class="org-comment-delimiter">(* </span><span class="org-comment">&lt;&#966;&gt; </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Quantifier</span> <span class="org-keyword">of</span> quantifier        <span class="org-comment-delimiter">(* </span><span class="org-comment">Not formally part of Hunter's formalism </span><span class="org-comment-delimiter">*)</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">string_of_formula</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">f </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">formula</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> f <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Constant</span> x        <span class="org-tuareg-font-lock-operator">-&gt;</span> x
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Variable</span> i        <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">Format.</span>sprintf <span class="org-string">"x_%d"</span> i
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Int</span> f             <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">Format.</span>sprintf <span class="org-string">"int(%s)"</span> <span class="org-tuareg-font-lock-operator">@@</span> string_of_formula f
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Inti</span> <span class="org-tuareg-font-lock-operator">(</span>f<span class="org-tuareg-font-lock-operator">,</span> i<span class="org-tuareg-font-lock-operator">)</span>       <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">Format.</span>sprintf <span class="org-string">"int_%d(%s)"</span> i <span class="org-tuareg-font-lock-operator">@@</span> string_of_formula f
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Ext</span> f             <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">Format.</span>sprintf <span class="org-string">"ext(%s)"</span> <span class="org-tuareg-font-lock-operator">@@</span> string_of_formula f
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>f1<span class="org-tuareg-font-lock-operator">,</span> f2<span class="org-tuareg-font-lock-operator">)</span>     <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">Format.</span>sprintf <span class="org-string">"%s &amp; %s"</span> <span class="org-tuareg-font-lock-operator">(</span>string_of_formula f1<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">(</span>string_of_formula f2<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Closure</span> f         <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">Format.</span>sprintf <span class="org-string">"&lt;%s&gt;"</span> <span class="org-tuareg-font-lock-operator">@@</span> string_of_formula f
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Quantifier</span> <span class="org-tuareg-font-lock-constructor">Exists</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-string">"some"</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Quantifier</span> <span class="org-tuareg-font-lock-constructor">Forall</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-string">"every"</span>
<span class="org-tuareg-font-lock-governing">and</span> <span class="org-function-name">toplevel_print_formula</span><span class="org-variable-name"> ppf </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">f </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">formula</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"%s"</span> <span class="org-tuareg-font-lock-operator">@@</span> string_of_formula f
</pre>
</div>

<p>
We'll need this helper for laterâ€”it checks whether (at the top level) a formula is a quantificational one. Implicitly, the structure here means that a quantificational formula must include a quantifier all the way to the right in its tree structure. We will take advantage of this to determine its scope.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">is_quantifier</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Quantifier</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">true</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>x<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">)</span>  <span class="org-tuareg-font-lock-operator">-&gt;</span> is_quantifier x
  <span class="org-tuareg-font-lock-operator">|</span> _            <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">false</span>
</pre>
</div>

<p>
Logical formulas have no inherent truth value, only a value within some model of the world. Models are a combination of:
</p>

<ul class="org-ul">
<li>Events which occur,</li>
<li>entities in the world,</li>
<li>assignments of pronouns to entities,</li>
<li>and lists of entities satisfying predicates.</li>
</ul>

<p>
Note that we have both one-place and two-place predicates. While the logical forms themselves solely involve monadic predicates, we will need dyadic predicates when evaluating the truth value, since the relations \(\mathsf{Internal}\) and \(\mathsf{External}\) are dyadic, and part of the semantics, even if they do not appear directly in the logical form. Put another way, we use monadic predicates to implicitly associate entities with events through theta roles, but our model needs to make this explicit.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">model</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">{</span>
    events<span class="org-tuareg-font-lock-operator">:</span>      string list<span class="org-tuareg-font-lock-operator">;</span>
    entities<span class="org-tuareg-font-lock-operator">:</span>    string list<span class="org-tuareg-font-lock-operator">;</span>
    assignments<span class="org-tuareg-font-lock-operator">:</span> <span class="org-tuareg-font-lock-operator">(</span>int <span class="org-tuareg-font-lock-operator">*</span> string<span class="org-tuareg-font-lock-operator">)</span> list<span class="org-tuareg-font-lock-operator">;</span>
    predicates<span class="org-tuareg-font-lock-operator">:</span>  <span class="org-tuareg-font-lock-operator">(</span>string <span class="org-tuareg-font-lock-operator">*</span> string list<span class="org-tuareg-font-lock-operator">)</span> list<span class="org-tuareg-font-lock-operator">;</span>
    predicates2<span class="org-tuareg-font-lock-operator">:</span> <span class="org-tuareg-font-lock-operator">(</span>string <span class="org-tuareg-font-lock-operator">*</span> <span class="org-tuareg-font-lock-operator">(</span>string <span class="org-tuareg-font-lock-operator">*</span> string<span class="org-tuareg-font-lock-operator">)</span> list<span class="org-tuareg-font-lock-operator">)</span> list<span class="org-tuareg-font-lock-operator">;</span>
  <span class="org-tuareg-font-lock-operator">}</span>
</pre>
</div>

<p>
We can ask whether a formula is true or false under some model, or whether a particular entity satisfies it. This is mostly for our convenience, as the user will use a wrapper hiding these details.
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">value</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Entity</span> <span class="org-keyword">of</span> string
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">True</span>
  <span class="org-tuareg-font-lock-operator">|</span> False
</pre>
</div>

<p>
Evaluation (This function essentially corresponds to \(\mathsf{Val}\) in Hunter's semantics.)
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">has_value</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">value </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">value</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">model </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">model</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">formula </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> bool</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
    <span class="org-comment-delimiter">(* </span><span class="org-warning">TODO</span><span class="org-comment">: make this compositional so "some girl" still works </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Quantifier</span> q<span class="org-tuareg-font-lock-operator">,</span> f1<span class="org-tuareg-font-lock-operator">),</span> f2<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> quantifier q value model f1 f2
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Constant</span> c                         <span class="org-tuareg-font-lock-operator">-&gt;</span> lookup_constant value model c
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>f1<span class="org-tuareg-font-lock-operator">,</span> f2<span class="org-tuareg-font-lock-operator">)</span>                      <span class="org-tuareg-font-lock-operator">-&gt;</span> has_value value model f1 <span class="org-tuareg-font-lock-operator">&amp;&amp;</span> has_value value model f2
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Closure</span> f                          <span class="org-tuareg-font-lock-operator">-&gt;</span> closure value model f
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Int</span> f                              <span class="org-tuareg-font-lock-operator">-&gt;</span> predicate <span class="org-string">"int"</span> value model f
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Inti</span> <span class="org-tuareg-font-lock-operator">(</span>f<span class="org-tuareg-font-lock-operator">,</span> i<span class="org-tuareg-font-lock-operator">)</span>                        <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-builtin">failwith</span> <span class="org-string">"has_value: unimplemented Inti"</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Ext</span> f                              <span class="org-tuareg-font-lock-operator">-&gt;</span> predicate <span class="org-string">"ext"</span> value model f
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Variable</span> i                         <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Entity</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">List.</span>assoc i model.assignments<span class="org-tuareg-font-lock-operator">))</span> <span class="org-tuareg-font-lock-operator">=</span> value
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Quantifier</span> _                       <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">false</span>  <span class="org-comment-delimiter">(* </span><span class="org-comment">Quantifiers themselves have no value </span><span class="org-comment-delimiter">*)</span>
<span class="org-tuareg-font-lock-governing">and</span> <span class="org-function-name">quantifier</span><span class="org-variable-name"> quant value model predicate formula</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">qfunc</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">match</span> quant <span class="org-keyword">with</span>
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Exists</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">List.</span>exists
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Forall</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">List.</span>for_all <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">with_assignment</span><span class="org-variable-name"> model entity index</span> <span class="org-tuareg-font-lock-operator">=</span>
    <span class="org-tuareg-font-lock-operator">{</span> model <span class="org-keyword">with</span> assignments <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">(</span>index<span class="org-tuareg-font-lock-operator">,</span> entity<span class="org-tuareg-font-lock-operator">)::</span>model.assignments <span class="org-tuareg-font-lock-operator">}</span> <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-keyword">match</span> value<span class="org-tuareg-font-lock-operator">,</span> predicate <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">True</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Inti</span> <span class="org-tuareg-font-lock-operator">(</span>f<span class="org-tuareg-font-lock-operator">,</span> i<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">satisfiers</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>filter <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">ent</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> has_value <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Entity</span> ent<span class="org-tuareg-font-lock-operator">)</span> model f<span class="org-tuareg-font-lock-operator">)</span> model.entities <span class="org-tuareg-font-lock-governing">in</span>
     qfunc <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">ent</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> has_value <span class="org-tuareg-font-lock-constructor">True</span> <span class="org-tuareg-font-lock-operator">(</span>with_assignment model ent i<span class="org-tuareg-font-lock-operator">)</span> formula<span class="org-tuareg-font-lock-operator">)</span> satisfiers
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">False</span><span class="org-tuareg-font-lock-operator">,</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">not</span> <span class="org-tuareg-font-lock-operator">(</span>quantifier quant <span class="org-tuareg-font-lock-constructor">True</span> model predicate formula<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Entity</span> _<span class="org-tuareg-font-lock-operator">,</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-builtin">failwith</span> <span class="org-string">"Individual entities cannot be quantified"</span>
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-builtin">failwith</span> <span class="org-string">"Quantifiers must be used with indexed theta role assigners"</span>
<span class="org-tuareg-font-lock-governing">and</span> <span class="org-function-name">lookup_constant</span><span class="org-variable-name"> value model constant</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">match</span> value <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">True</span> <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">False</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">false</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Entity</span> e <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">in_predicates</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">try</span>
         <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">list</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>assoc constant model.predicates <span class="org-tuareg-font-lock-governing">in</span>
         <span class="org-tuareg-font-lock-module">List.</span>exists <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">x</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> x <span class="org-tuareg-font-lock-operator">=</span> e<span class="org-tuareg-font-lock-operator">)</span> list
       <span class="org-keyword">with</span>
       <span class="org-tuareg-font-lock-operator">|</span> <span class="org-builtin">Not_found</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">false</span> <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">in_entities</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>exists <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">x</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> x <span class="org-tuareg-font-lock-operator">=</span> e<span class="org-tuareg-font-lock-operator">)</span> model.entities <span class="org-tuareg-font-lock-operator">&amp;&amp;</span> e <span class="org-tuareg-font-lock-operator">=</span> constant <span class="org-tuareg-font-lock-governing">in</span>
     in_predicates <span class="org-tuareg-font-lock-operator">||</span> in_entities
<span class="org-tuareg-font-lock-governing">and</span> <span class="org-function-name">closure</span><span class="org-variable-name"> value model formula</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">match</span> value <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">True</span>     <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">List.</span>exists <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">e</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> closure <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Entity</span> e<span class="org-tuareg-font-lock-operator">)</span> model formula<span class="org-tuareg-font-lock-operator">)</span> model.events
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">False</span>    <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">not</span> <span class="org-tuareg-font-lock-operator">(</span>closure <span class="org-tuareg-font-lock-constructor">True</span> model formula<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Entity</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> has_value value model formula
<span class="org-tuareg-font-lock-governing">and</span> <span class="org-function-name">predicate</span><span class="org-variable-name"> pred value model formula</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">match</span> value <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">True</span>       <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">List.</span>exists <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">e</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> predicate pred <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Entity</span> e<span class="org-tuareg-font-lock-operator">)</span> model formula<span class="org-tuareg-font-lock-operator">)</span> model.events
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">False</span>      <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">not</span> <span class="org-tuareg-font-lock-operator">(</span>predicate pred <span class="org-tuareg-font-lock-constructor">True</span> model formula<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Entity</span> evt <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">List.</span>exists <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">ent</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> lookup_predicate2 model pred evt ent <span class="org-tuareg-font-lock-operator">&amp;&amp;</span> has_value <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Entity</span> ent<span class="org-tuareg-font-lock-operator">)</span> model formula<span class="org-tuareg-font-lock-operator">)</span> model.entities
<span class="org-tuareg-font-lock-governing">and</span> <span class="org-function-name">lookup_predicate2</span><span class="org-variable-name"> model predicate </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">event </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">string</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">entity </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">string</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">internals</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>assoc predicate model.predicates2 <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-module">List.</span>exists <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">x</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> x <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">(</span>event<span class="org-tuareg-font-lock-operator">,</span> entity<span class="org-tuareg-font-lock-operator">))</span> internals
<span class="org-tuareg-font-lock-governing">and</span> <span class="org-function-name">eval</span><span class="org-variable-name"> model formula</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">bool</span> <span class="org-tuareg-font-lock-operator">=</span> has_value <span class="org-tuareg-font-lock-constructor">True</span> model formula
</pre>
</div>
</div>
</section>

<section id="outline-container-orgba488b3" class="outline-2">
<h2 id="orgba488b3"><span class="section-number-2">2</span> Tokenization</h2>
<div class="outline-text-2" id="text-2">
<p>
We are parsing English, so tokenization is simple; we simply split on whitespace.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">token</span> <span class="org-tuareg-font-lock-operator">=</span> string

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">tokenize</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">string </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> token list </span><span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">String.</span>split_on_char <span class="org-string">' '</span>
</pre>
</div>
</div>
</section>

<section id="outline-container-org3f1587a" class="outline-2">
<h2 id="org3f1587a"><span class="section-number-2">3</span> Minimalist Grammar</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-org1ebb4c9" class="outline-3">
<h3 id="org1ebb4c9"><span class="section-number-3">3.1</span> Features</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Hunter's conception of MG only includes movement features, along with an additional feature used solely for adjuncts. This special <code>*f</code> feature is not checked, but is selected by <code>-f</code> features.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">feature</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Licensor</span> <span class="org-keyword">of</span> string
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Licensee</span> <span class="org-keyword">of</span> string
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Adjunct</span>  <span class="org-keyword">of</span> string

<span class="org-comment-delimiter">(* </span><span class="org-comment">Helper functions for quickly creating features. </span><span class="org-comment-delimiter">*)</span>
<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">lic</span><span class="org-variable-name"> f</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Licensor</span> f
<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">lie</span><span class="org-variable-name"> f</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Licensee</span> f
<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">adj</span><span class="org-variable-name"> f</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Adjunct</span>  f

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">string_of_feature</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">feat </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">feature</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> feat <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Licensor</span> c <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">Format.</span>sprintf <span class="org-string">"+%s"</span> c
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Licensee</span> c <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">Format.</span>sprintf <span class="org-string">"-%s"</span> c
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Adjunct</span>  c <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">Format.</span>sprintf <span class="org-string">"*%s"</span> c

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">toplevel_print_feature</span><span class="org-variable-name"> ppf </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">feat </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">feature</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"%s"</span> <span class="org-tuareg-font-lock-operator">@@</span> string_of_feature feat
</pre>
</div>
</div>

<div id="outline-container-org67b07a0" class="outline-4">
<h4 id="org67b07a0"><span class="section-number-4">3.1.1</span> Lexicon</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Our lexicon simply consists of words with features and a logical form.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">lexical_item</span> <span class="org-tuareg-font-lock-operator">=</span> token <span class="org-tuareg-font-lock-operator">*</span> feature list <span class="org-tuareg-font-lock-operator">*</span> formula
<span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">lexicon</span> <span class="org-tuareg-font-lock-operator">=</span> lexical_item list
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbb87e17" class="outline-3">
<h3 id="orgbb87e17"><span class="section-number-3">3.2</span> Grammar</h3>
<div class="outline-text-3" id="text-3-2">
<p>
A grammar is simply a list of lexical entries and a list of start symbols, used to determine when we are done parsing.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">grammar</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">{</span>
    start_symbols<span class="org-tuareg-font-lock-operator">:</span> string list<span class="org-tuareg-font-lock-operator">;</span>
    lexicon<span class="org-tuareg-font-lock-operator">:</span> lexicon<span class="org-tuareg-font-lock-operator">;</span>
  <span class="org-tuareg-font-lock-operator">}</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">lookup_lexicon</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">grammar </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">grammar</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">token </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">token</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">lexical_item list</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-module">List.</span>filter <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">tok</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> tok <span class="org-tuareg-font-lock-operator">=</span> token<span class="org-tuareg-font-lock-operator">)</span> grammar.lexicon
</pre>
</div>
</div>
</div>

<div id="outline-container-org6f2592b" class="outline-3">
<h3 id="org6f2592b"><span class="section-number-3">3.3</span> Parsing</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Parsing for Hunter's MG differs greatly from other formulations. Because we have only movement features, anything may combine with any other term in any position. Thus, while our parser has the structure of a standard chart parser like CKY, it does not function as efficiently.
</p>

<p>
Expressions consist of a phonological form, a kind, a list of features, a list of arguments, a list of children, and a logical form. The kind determines whether the expression was inserted from the lexicon or formed by combining other expressions. Arguments and children are used for deriving logical forms, as will be seen. Instead of having merge and move operations, this MG formalism uses merge and insert operations, described below, which necessitate the argument and children lists.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">kind</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Lexical</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Derived</span>

<span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">argument</span> <span class="org-tuareg-font-lock-operator">=</span> string <span class="org-tuareg-font-lock-operator">*</span> string <span class="org-tuareg-font-lock-operator">*</span> formula

<span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">expression</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-keyword">of</span> string <span class="org-tuareg-font-lock-operator">*</span> kind <span class="org-tuareg-font-lock-operator">*</span> feature list <span class="org-tuareg-font-lock-operator">*</span> argument list <span class="org-tuareg-font-lock-operator">*</span> expression list <span class="org-tuareg-font-lock-operator">*</span> formula

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">string_of_argument</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">token</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> category</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> meaning</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">begin</span>
    <span class="org-tuareg-font-lock-module">Format.</span>sprintf
      <span class="org-string">"%s %s = %s"</span>
      token category <span class="org-tuareg-font-lock-operator">(</span>string_of_formula meaning<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-governing">end</span>
<span class="org-tuareg-font-lock-governing">and</span> <span class="org-function-name">toplevel_print_argument</span><span class="org-variable-name"> ppf arg</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">begin</span>
    <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"%s"</span> <span class="org-tuareg-font-lock-operator">(</span>string_of_argument arg<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-governing">end</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">string_of_expr</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">token</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> kind</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> features</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> args</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> children</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> meaning</span><span class="org-tuareg-font-lock-operator">))</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">begin</span>
    <span class="org-tuareg-font-lock-module">Format.</span>sprintf
      <span class="org-string">"&lt;%s%s%s = %s%s%s&gt;"</span>
      token
      <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">match</span> kind <span class="org-keyword">with</span>
       <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Lexical</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-string">"::"</span>
       <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Derived</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-string">":"</span><span class="org-tuareg-font-lock-operator">)</span>
      <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">" "</span> <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">List.</span>map string_of_feature features<span class="org-tuareg-font-lock-operator">)</span>
      <span class="org-tuareg-font-lock-operator">(</span>string_of_formula meaning<span class="org-tuareg-font-lock-operator">)</span>
      <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">if</span> args <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[]</span> <span class="org-keyword">then</span> <span class="org-string">""</span> <span class="org-keyword">else</span>
         <span class="org-string">", "</span> <span class="org-tuareg-font-lock-operator">^</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">", "</span> <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">List.</span>map string_of_argument args<span class="org-tuareg-font-lock-operator">))</span>
      <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">if</span> children <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[]</span> <span class="org-keyword">then</span> <span class="org-string">", {}"</span> <span class="org-keyword">else</span>
         <span class="org-string">", {"</span> <span class="org-tuareg-font-lock-operator">^</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">", "</span> <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">List.</span>map string_of_expr children<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">^</span> <span class="org-string">"}"</span><span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-governing">end</span>
<span class="org-tuareg-font-lock-governing">and</span> <span class="org-function-name">toplevel_print_expr</span><span class="org-variable-name"> ppf expr</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">begin</span>
    <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"%s"</span> <span class="org-tuareg-font-lock-operator">(</span>string_of_expr expr<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-governing">end</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">expr_of_lexical</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">lex </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">lexical_item</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">expression</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">token</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> features</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> formula</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> lex <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Lexical</span><span class="org-tuareg-font-lock-operator">,</span> features<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[],</span> <span class="org-tuareg-font-lock-operator">[],</span> formula<span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">get_expr_token</span><span class="org-variable-name">   </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">token</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name">   </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">string</span> <span class="org-tuareg-font-lock-operator">=</span> token
<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">get_expr_meaning</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">_</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> meaning</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">formula</span> <span class="org-tuareg-font-lock-operator">=</span> meaning
</pre>
</div>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">gensym</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">counter</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-builtin">ref</span> 0 <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-keyword">fun</span> <span class="org-tuareg-font-lock-operator">()</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">result</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">!</span>counter <span class="org-tuareg-font-lock-governing">in</span>
  counter <span class="org-tuareg-font-lock-operator">:=</span> result <span class="org-tuareg-font-lock-operator">+</span> 1<span class="org-tuareg-font-lock-operator">;</span>
  result

<span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">OrderedInt</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">Set.</span><span class="org-tuareg-font-lock-constructor">OrderedType</span> <span class="org-tuareg-font-lock-governing">with type</span> <span class="org-type">t</span><span class="org-tuareg-font-lock-operator">=</span>int<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
<span class="org-tuareg-font-lock-governing">struct</span>
  <span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">t</span> <span class="org-tuareg-font-lock-operator">=</span> int
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">compare</span> <span class="org-tuareg-font-lock-operator">=</span> compare
<span class="org-tuareg-font-lock-governing">end</span>
<span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">RetiredSet</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">Set.Make</span><span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">OrderedInt</span><span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">derivation</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-constructor">LexicalEntry</span> <span class="org-tuareg-font-lock-operator">|</span>
  <span class="org-tuareg-font-lock-constructor">DerivedEntry</span> <span class="org-keyword">of</span> string <span class="org-tuareg-font-lock-operator">*</span> chart_entry list <span class="org-tuareg-font-lock-operator">*</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>t
 <span class="org-tuareg-font-lock-governing">and</span> <span class="org-variable-name">chart_entry</span> <span class="org-tuareg-font-lock-operator">=</span> int <span class="org-tuareg-font-lock-operator">*</span> expression <span class="org-tuareg-font-lock-operator">*</span> derivation

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">format_derivation</span><span class="org-variable-name"> ppf chart_entry</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">gensym</span> <span class="org-tuareg-font-lock-operator">=</span>
    <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">counter</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-builtin">ref</span> 0 <span class="org-tuareg-font-lock-governing">in</span>
    <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-tuareg-font-lock-operator">()</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
      <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">v</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">!</span>counter <span class="org-tuareg-font-lock-governing">in</span>
      counter <span class="org-tuareg-font-lock-operator">:=</span> v <span class="org-tuareg-font-lock-operator">+</span> 1<span class="org-tuareg-font-lock-operator">;</span>
      <span class="org-string">"e"</span> <span class="org-tuareg-font-lock-operator">^</span> <span class="org-tuareg-font-lock-operator">(</span>string_of_int v<span class="org-tuareg-font-lock-operator">)</span>
    <span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">traverse</span><span class="org-variable-name"> fl fd </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">_</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> expr</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> derivation</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
    <span class="org-keyword">match</span> derivation <span class="org-keyword">with</span>
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">LexicalEntry</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
       <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">label</span> <span class="org-tuareg-font-lock-operator">=</span> gensym <span class="org-tuareg-font-lock-operator">()</span> <span class="org-tuareg-font-lock-governing">in</span>
       fl label expr<span class="org-tuareg-font-lock-operator">;</span>
       label
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">DerivedEntry</span> <span class="org-tuareg-font-lock-operator">(</span>op<span class="org-tuareg-font-lock-operator">,</span> children<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
       <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">labels</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>map <span class="org-tuareg-font-lock-operator">(</span>traverse fl fd<span class="org-tuareg-font-lock-operator">)</span> children <span class="org-tuareg-font-lock-governing">in</span>
       <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">label</span> <span class="org-tuareg-font-lock-operator">=</span> gensym <span class="org-tuareg-font-lock-operator">()</span> <span class="org-tuareg-font-lock-governing">in</span>
       fd label expr op labels<span class="org-tuareg-font-lock-operator">;</span>
       label
  <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-builtin">ignore</span> <span class="org-tuareg-font-lock-operator">@@</span> traverse
              <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">label expr</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
                <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"%s = "</span> label<span class="org-tuareg-font-lock-operator">;</span>
                toplevel_print_expr ppf expr<span class="org-tuareg-font-lock-operator">;</span>
                <span class="org-tuareg-font-lock-module">Format.</span>pp_print_newline ppf <span class="org-tuareg-font-lock-operator">())</span>
              <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">label expr op children</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
                <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"%s = %s(%s) = "</span> label op <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">", "</span> children<span class="org-tuareg-font-lock-operator">);</span>
                toplevel_print_expr ppf expr<span class="org-tuareg-font-lock-operator">;</span>
                <span class="org-tuareg-font-lock-module">Format.</span>pp_print_newline ppf <span class="org-tuareg-font-lock-operator">())</span>
    chart_entry

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">chart_of_lexical</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">lex </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">lexical_item</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">chart_entry</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-operator">(</span>gensym <span class="org-tuareg-font-lock-operator">(),</span> expr_of_lexical lex<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">LexicalEntry</span><span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">OrderedExpression</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">Set.</span><span class="org-tuareg-font-lock-constructor">OrderedType</span> <span class="org-tuareg-font-lock-governing">with type</span> <span class="org-type">t</span><span class="org-tuareg-font-lock-operator">=</span>chart_entry<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
<span class="org-tuareg-font-lock-governing">struct</span>
  <span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">t</span> <span class="org-tuareg-font-lock-operator">=</span> chart_entry
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">compare</span> <span class="org-tuareg-font-lock-operator">=</span> compare
<span class="org-tuareg-font-lock-governing">end</span>

<span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">ExpressionSet</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">Set.Make</span><span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">OrderedExpression</span><span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">chart</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">ExpressionSet.</span>t

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">map_chart</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">f </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">chart_entry </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> 'a</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">chart </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">chart</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">'a list</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-module">List.</span>rev_map f <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">ExpressionSet.</span>elements chart

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">insert_chart</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">entry </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">chart_entry</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">chart </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">chart</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">chart</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-module">ExpressionSet.</span>add entry chart

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">toplevel_print_exprset</span><span class="org-variable-name"> ppf </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">s </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-module">ExpressionSet.</span><span class="org-type">t</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"["</span><span class="org-tuareg-font-lock-operator">;</span>
  <span class="org-tuareg-font-lock-module">ExpressionSet.</span>iter <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">_</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> e</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> deriv</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> toplevel_print_expr ppf e<span class="org-tuareg-font-lock-operator">;</span> <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"; "</span><span class="org-tuareg-font-lock-operator">)</span> s<span class="org-tuareg-font-lock-operator">;</span>
  <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"]"</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">toplevel_print_chart</span><span class="org-variable-name"> ppf </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">chart </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">chart</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-module">Format.</span>fprintf ppf <span class="org-string">"{%s}"</span> <span class="org-tuareg-font-lock-operator">@@</span>
    <span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">", "</span> <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">List.</span>map <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">_</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> x</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> string_of_expr x<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">ExpressionSet.</span>elements chart<span class="org-tuareg-font-lock-operator">;;</span>

<span class="org-tuareg-font-lock-operator">#</span>install_printer toplevel_print_argument<span class="org-tuareg-font-lock-operator">;;</span>
<span class="org-tuareg-font-lock-operator">#</span>install_printer toplevel_print_expr<span class="org-tuareg-font-lock-operator">;;</span>
<span class="org-tuareg-font-lock-operator">#</span>install_printer toplevel_print_exprset<span class="org-tuareg-font-lock-operator">;;</span>
<span class="org-tuareg-font-lock-operator">#</span>install_printer toplevel_print_chart<span class="org-tuareg-font-lock-operator">;;</span>

<span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">agenda</span> <span class="org-tuareg-font-lock-operator">=</span> chart_entry list

<span class="org-tuareg-font-lock-governing">type</span> <span class="org-type">parse_state</span> <span class="org-tuareg-font-lock-operator">=</span> grammar <span class="org-tuareg-font-lock-operator">*</span> int list <span class="org-tuareg-font-lock-operator">*</span> agenda <span class="org-tuareg-font-lock-operator">*</span> chart

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">initial_state</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">grammar </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">grammar</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">toks </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">token list</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">parse_state</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">empties</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>rev_map chart_of_lexical <span class="org-tuareg-font-lock-operator">@@</span> lookup_lexicon grammar <span class="org-string">""</span> <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">lexical</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>concat <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">List.</span>mapi <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">idx tok</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
      <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">lexical_items</span> <span class="org-tuareg-font-lock-operator">=</span> lookup_lexicon grammar tok <span class="org-tuareg-font-lock-governing">in</span>
      <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">exprs</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>map chart_of_lexical lexical_items <span class="org-tuareg-font-lock-governing">in</span>
      exprs
    <span class="org-tuareg-font-lock-operator">)</span> toks <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">chart</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">ExpressionSet.</span>of_list <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">List.</span>rev_append lexical empties<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-operator">(</span>grammar<span class="org-tuareg-font-lock-operator">,</span> map_chart <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">i</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> i<span class="org-tuareg-font-lock-operator">)</span> chart<span class="org-tuareg-font-lock-operator">,</span> map_chart <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">x</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> x<span class="org-tuareg-font-lock-operator">)</span> chart<span class="org-tuareg-font-lock-operator">,</span> chart<span class="org-tuareg-font-lock-operator">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-doc">(** These operations are from [Kobele06; pg. 118] and [Fowlie]. *)</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">genint</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">counter</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-builtin">ref</span> 0 <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-keyword">fun</span> <span class="org-variable-name">formula </span><span class="org-tuareg-font-lock-operator">()</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
  counter <span class="org-tuareg-font-lock-operator">:=</span> <span class="org-tuareg-font-lock-operator">(!</span>counter<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-</span> 1<span class="org-tuareg-font-lock-operator">;</span>
  <span class="org-tuareg-font-lock-constructor">Inti</span> <span class="org-tuareg-font-lock-operator">(</span>formula<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">!</span>counter<span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">is_licensee_of</span><span class="org-variable-name"> cat</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">expression </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> bool</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensee</span> cat'<span class="org-tuareg-font-lock-operator">)::[],</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">)</span> <span class="org-keyword">when</span> cat <span class="org-tuareg-font-lock-operator">=</span> cat' <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">true</span>
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">false</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">is_nonfinal_licensee_of</span><span class="org-variable-name"> cat</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">expression </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> bool</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensee</span> cat'<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">)</span> <span class="org-keyword">when</span> cat <span class="org-tuareg-font-lock-operator">=</span> cat' <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">true</span>
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">false</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">map_option</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">f </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">'a </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> 'b</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">a </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">'a option</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">'b option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> a <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Some</span> x <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span>f x<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">None</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">bind_option</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">f </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">'a </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> 'b option</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">a </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">'a option</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">'b option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> a <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Some</span> x <span class="org-tuareg-font-lock-operator">-&gt;</span> f x
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">None</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">check</span><span class="org-variable-name"> expr1 expr2</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> expr1<span class="org-tuareg-font-lock-operator">,</span> expr2 <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>range1<span class="org-tuareg-font-lock-operator">,</span> kind1<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-tuareg-font-lock-constructor">Licensor</span> f<span class="org-tuareg-font-lock-operator">)::</span>alpha <span class="org-keyword">as</span> feats1<span class="org-tuareg-font-lock-operator">),</span> args1<span class="org-tuareg-font-lock-operator">,</span> children1<span class="org-tuareg-font-lock-operator">,</span> meaning1<span class="org-tuareg-font-lock-operator">),</span>
     <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>range2<span class="org-tuareg-font-lock-operator">,</span> kind2<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-tuareg-font-lock-constructor">Licensee</span> f'<span class="org-tuareg-font-lock-operator">)::</span>beta <span class="org-keyword">as</span> feats2<span class="org-tuareg-font-lock-operator">),</span> args2<span class="org-tuareg-font-lock-operator">,</span> children2<span class="org-tuareg-font-lock-operator">,</span> meaning2<span class="org-tuareg-font-lock-operator">))</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>range1<span class="org-tuareg-font-lock-operator">,</span> kind1<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-tuareg-font-lock-constructor">Licensee</span> f<span class="org-tuareg-font-lock-operator">)::</span>alpha <span class="org-keyword">as</span> feats1<span class="org-tuareg-font-lock-operator">),</span> args1<span class="org-tuareg-font-lock-operator">,</span> children1<span class="org-tuareg-font-lock-operator">,</span> meaning1<span class="org-tuareg-font-lock-operator">),</span>
     <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>range2<span class="org-tuareg-font-lock-operator">,</span> kind2<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-tuareg-font-lock-constructor">Adjunct</span> f'<span class="org-tuareg-font-lock-operator">)::</span>beta <span class="org-keyword">as</span> feats2<span class="org-tuareg-font-lock-operator">),</span> args2<span class="org-tuareg-font-lock-operator">,</span> children2<span class="org-tuareg-font-lock-operator">,</span> meaning2<span class="org-tuareg-font-lock-operator">))</span>
       <span class="org-keyword">when</span> f <span class="org-tuareg-font-lock-operator">=</span> f' <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">child</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>range2<span class="org-tuareg-font-lock-operator">,</span> kind2<span class="org-tuareg-font-lock-operator">,</span> feats2<span class="org-tuareg-font-lock-operator">,</span> args2<span class="org-tuareg-font-lock-operator">,</span> children2<span class="org-tuareg-font-lock-operator">,</span> meaning2<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>range1<span class="org-tuareg-font-lock-operator">,</span> kind1<span class="org-tuareg-font-lock-operator">,</span> feats1<span class="org-tuareg-font-lock-operator">,</span> args1<span class="org-tuareg-font-lock-operator">,</span> child<span class="org-tuareg-font-lock-operator">::</span>children1<span class="org-tuareg-font-lock-operator">,</span> meaning1<span class="org-tuareg-font-lock-operator">))</span>
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">insert_adjunct</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">expr1 </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">expr2 </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">expression option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> expr1<span class="org-tuareg-font-lock-operator">,</span> expr2 <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensee</span> f<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">),</span>
     <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Adjunct</span> f'<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">))</span>
       <span class="org-keyword">when</span> f <span class="org-tuareg-font-lock-operator">=</span> f' <span class="org-tuareg-font-lock-operator">-&gt;</span>
     check expr1 expr2
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Adjunct</span> f'<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">),</span>
     <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensee</span> f<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">))</span>
       <span class="org-keyword">when</span> f <span class="org-tuareg-font-lock-operator">=</span> f' <span class="org-tuareg-font-lock-operator">-&gt;</span>
     check expr2 expr1
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">insert</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">expr1 </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">expr2 </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">expression option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> expr1<span class="org-tuareg-font-lock-operator">,</span> expr2 <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensor</span> f<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">),</span>
     <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensee</span> f'<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">))</span>
       <span class="org-keyword">when</span> f <span class="org-tuareg-font-lock-operator">=</span> f' <span class="org-tuareg-font-lock-operator">-&gt;</span>
     check expr1 expr2
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensee</span> f'<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">),</span>
     <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensor</span> f<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">))</span>
       <span class="org-keyword">when</span> f <span class="org-tuareg-font-lock-operator">=</span> f' <span class="org-tuareg-font-lock-operator">-&gt;</span>
     check expr2 expr1
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">spellout</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">expr </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">expression option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">is_adjunct</span><span class="org-variable-name"> expr</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">match</span> expr <span class="org-keyword">with</span>
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Adjunct</span> _<span class="org-tuareg-font-lock-operator">)::</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">true</span>
    <span class="org-tuareg-font-lock-operator">|</span> _                                    <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">false</span>
  <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">meaning_of_adjuncts</span><span class="org-variable-name"> base</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[]</span>    <span class="org-tuareg-font-lock-operator">-&gt;</span> base
    <span class="org-tuareg-font-lock-operator">|</span> x<span class="org-tuareg-font-lock-operator">::</span>xs <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>get_expr_meaning x<span class="org-tuareg-font-lock-operator">,</span> meaning_of_adjuncts base xs<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">phonological_of_adjuncts</span><span class="org-variable-name"> adjuncts</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">match</span> adjuncts <span class="org-keyword">with</span>
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[]</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-string">""</span>
    <span class="org-tuareg-font-lock-operator">|</span> _  <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-string">" "</span> <span class="org-tuareg-font-lock-operator">^</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">" "</span> <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">List.</span>map get_expr_token adjuncts<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-keyword">match</span> expr <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-tuareg-font-lock-constructor">Licensee</span> <span class="org-string">"c"</span><span class="org-tuareg-font-lock-operator">)::</span>_ <span class="org-keyword">as</span> features<span class="org-tuareg-font-lock-operator">),</span> <span class="org-tuareg-font-lock-operator">[(</span>ext<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> ext_arg<span class="org-tuareg-font-lock-operator">)],</span> children<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">adjuncts</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> children'</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>partition is_adjunct children <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">adjunct_spellout</span>      <span class="org-tuareg-font-lock-operator">=</span> phonological_of_adjuncts adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">phonological</span>          <span class="org-tuareg-font-lock-operator">=</span> ext <span class="org-tuareg-font-lock-operator">^</span> adjunct_spellout <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">base_meaning</span>          <span class="org-tuareg-font-lock-operator">=</span> ext_arg <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">meaning'</span>              <span class="org-tuareg-font-lock-operator">=</span> meaning_of_adjuncts base_meaning adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>phonological<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> features<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[],</span> children'<span class="org-tuareg-font-lock-operator">,</span> meaning'<span class="org-tuareg-font-lock-operator">))</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-tuareg-font-lock-constructor">Licensee</span> <span class="org-string">"c"</span><span class="org-tuareg-font-lock-operator">)::</span>_ <span class="org-keyword">as</span> features<span class="org-tuareg-font-lock-operator">),</span> <span class="org-tuareg-font-lock-operator">[(</span>ext<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> ext_arg<span class="org-tuareg-font-lock-operator">);</span> <span class="org-tuareg-font-lock-operator">(</span>int<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> int_arg<span class="org-tuareg-font-lock-operator">)],</span> children<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">adjuncts</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> children'</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>partition is_adjunct children <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">adjunct_spellout</span>      <span class="org-tuareg-font-lock-operator">=</span> phonological_of_adjuncts adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">phonological</span>          <span class="org-tuareg-font-lock-operator">=</span> int <span class="org-tuareg-font-lock-operator">^</span> adjunct_spellout <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">base_meaning</span>          <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>ext_arg<span class="org-tuareg-font-lock-operator">,</span> int_arg<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">meaning'</span>              <span class="org-tuareg-font-lock-operator">=</span> meaning_of_adjuncts base_meaning adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>phonological<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> features<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[],</span> children'<span class="org-tuareg-font-lock-operator">,</span> meaning'<span class="org-tuareg-font-lock-operator">))</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-tuareg-font-lock-constructor">Licensee</span> <span class="org-string">"v"</span><span class="org-tuareg-font-lock-operator">)::</span>_ <span class="org-keyword">as</span> features<span class="org-tuareg-font-lock-operator">),</span> <span class="org-tuareg-font-lock-operator">[(</span>ext<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> ext_arg<span class="org-tuareg-font-lock-operator">)],</span> children<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">adjuncts</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> children'</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>partition is_adjunct children <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">adjunct_spellout</span>      <span class="org-tuareg-font-lock-operator">=</span> phonological_of_adjuncts adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">phonological</span>          <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">" "</span> <span class="org-tuareg-font-lock-operator">[</span>ext<span class="org-tuareg-font-lock-operator">;</span> token<span class="org-tuareg-font-lock-operator">])</span> <span class="org-tuareg-font-lock-operator">^</span> adjunct_spellout <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">base_meaning</span>          <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>meaning<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Ext</span> ext_arg<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">meaning'</span>              <span class="org-tuareg-font-lock-operator">=</span> meaning_of_adjuncts base_meaning adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>phonological<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> features<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[],</span> children'<span class="org-tuareg-font-lock-operator">,</span> meaning'<span class="org-tuareg-font-lock-operator">))</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-tuareg-font-lock-constructor">Licensee</span> _<span class="org-tuareg-font-lock-operator">)::</span>_ <span class="org-keyword">as</span> features<span class="org-tuareg-font-lock-operator">),</span> <span class="org-tuareg-font-lock-operator">[(</span>ext<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> ext_arg<span class="org-tuareg-font-lock-operator">)],</span> children<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">)</span>
       <span class="org-keyword">when</span> is_quantifier meaning <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">adjuncts</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> children'</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>partition is_adjunct children <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">adjunct_spellout</span>      <span class="org-tuareg-font-lock-operator">=</span> phonological_of_adjuncts adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">phonological</span>          <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">" "</span> <span class="org-tuareg-font-lock-operator">[</span>token<span class="org-tuareg-font-lock-operator">;</span> ext<span class="org-tuareg-font-lock-operator">])</span> <span class="org-tuareg-font-lock-operator">^</span> adjunct_spellout <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">base_meaning</span>          <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>meaning<span class="org-tuareg-font-lock-operator">,</span> genint ext_arg <span class="org-tuareg-font-lock-operator">())</span> <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">meaning'</span>              <span class="org-tuareg-font-lock-operator">=</span> meaning_of_adjuncts base_meaning adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>phonological<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> features<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[],</span> children'<span class="org-tuareg-font-lock-operator">,</span> meaning'<span class="org-tuareg-font-lock-operator">))</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-tuareg-font-lock-constructor">Licensee</span> _<span class="org-tuareg-font-lock-operator">)::</span>_ <span class="org-keyword">as</span> features<span class="org-tuareg-font-lock-operator">),</span> <span class="org-tuareg-font-lock-operator">[(</span>ext<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> ext_arg<span class="org-tuareg-font-lock-operator">)],</span> children<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">adjuncts</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> children'</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>partition is_adjunct children <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">adjunct_spellout</span>      <span class="org-tuareg-font-lock-operator">=</span> phonological_of_adjuncts adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">phonological</span>          <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">" "</span> <span class="org-tuareg-font-lock-operator">[</span>token<span class="org-tuareg-font-lock-operator">;</span> ext<span class="org-tuareg-font-lock-operator">])</span> <span class="org-tuareg-font-lock-operator">^</span> adjunct_spellout <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">base_meaning</span>          <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>meaning<span class="org-tuareg-font-lock-operator">,</span> ext_arg<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">meaning'</span>              <span class="org-tuareg-font-lock-operator">=</span> meaning_of_adjuncts base_meaning adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>phonological<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> features<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[],</span> children'<span class="org-tuareg-font-lock-operator">,</span> meaning'<span class="org-tuareg-font-lock-operator">))</span>
    <span class="org-comment-delimiter">(* </span><span class="org-comment">Order of arguments below is backwards compared to Hunter (2011) p. 74 </span><span class="org-comment-delimiter">*)</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> features<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[(</span>ext<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> ext_arg<span class="org-tuareg-font-lock-operator">);</span> <span class="org-tuareg-font-lock-operator">(</span>int<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> int_arg<span class="org-tuareg-font-lock-operator">)],</span> children<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">adjuncts</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> children'</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>partition is_adjunct children <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">adjunct_spellout</span>      <span class="org-tuareg-font-lock-operator">=</span> phonological_of_adjuncts adjuncts <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">phonological</span>          <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">String.</span>concat <span class="org-string">" "</span> <span class="org-tuareg-font-lock-operator">[</span>ext<span class="org-tuareg-font-lock-operator">;</span> token<span class="org-tuareg-font-lock-operator">;</span> int<span class="org-tuareg-font-lock-operator">])</span> <span class="org-tuareg-font-lock-operator">^</span> adjunct_spellout <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">meaning'</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">match</span> features <span class="org-keyword">with</span>
       <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensee</span> <span class="org-string">"v"</span><span class="org-tuareg-font-lock-operator">)::</span>_ <span class="org-tuareg-font-lock-operator">-&gt;</span>
          <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">base_meaning</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>meaning<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Int</span> int_arg<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Ext</span> ext_arg<span class="org-tuareg-font-lock-operator">))</span> <span class="org-tuareg-font-lock-governing">in</span>
          meaning_of_adjuncts base_meaning adjuncts
       <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">Closure</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>meaning<span class="org-tuareg-font-lock-operator">,</span> int_arg<span class="org-tuareg-font-lock-operator">))</span> <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>phonological<span class="org-tuareg-font-lock-operator">,</span> kind<span class="org-tuareg-font-lock-operator">,</span> features<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[],</span> children'<span class="org-tuareg-font-lock-operator">,</span> meaning'<span class="org-tuareg-font-lock-operator">))</span>
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">list_remove</span><span class="org-variable-name"> predicate</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[]</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">([],</span> <span class="org-tuareg-font-lock-operator">[])</span>
  <span class="org-tuareg-font-lock-operator">|</span> x<span class="org-tuareg-font-lock-operator">::</span>xs <span class="org-keyword">when</span> predicate x <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">result</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> remainder</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> list_remove predicate xs <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-operator">(</span>x<span class="org-tuareg-font-lock-operator">::</span>result<span class="org-tuareg-font-lock-operator">,</span> remainder<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-operator">|</span> x<span class="org-tuareg-font-lock-operator">::</span>xs <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">result</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> remainder</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> list_remove predicate xs <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-operator">(</span>result<span class="org-tuareg-font-lock-operator">,</span> x<span class="org-tuareg-font-lock-operator">::</span>remainder<span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">merge_comp</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">expr </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">expression option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> expr <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token1<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Lexical</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensor</span> f<span class="org-tuareg-font-lock-operator">)::</span>alpha<span class="org-tuareg-font-lock-operator">,</span> args<span class="org-tuareg-font-lock-operator">,</span> children<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">licensees</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> children'</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> list_remove <span class="org-tuareg-font-lock-operator">(</span>is_licensee_of f<span class="org-tuareg-font-lock-operator">)</span> children <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">begin</span>
       <span class="org-keyword">match</span> licensees <span class="org-keyword">with</span>
       <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token2<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> children2<span class="org-tuareg-font-lock-operator">,</span> meaning2<span class="org-tuareg-font-lock-operator">)]</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
          <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token1<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Derived</span><span class="org-tuareg-font-lock-operator">,</span> alpha<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span>token2<span class="org-tuareg-font-lock-operator">,</span> f<span class="org-tuareg-font-lock-operator">,</span> meaning2<span class="org-tuareg-font-lock-operator">)::</span>args<span class="org-tuareg-font-lock-operator">,</span> children' <span class="org-tuareg-font-lock-operator">@</span> children2<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">))</span>
       <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>
     <span class="org-tuareg-font-lock-governing">end</span>
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">merge_spec</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">expr </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">expression option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> expr <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token1<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Derived</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensor</span> f<span class="org-tuareg-font-lock-operator">)::</span>alpha<span class="org-tuareg-font-lock-operator">,</span> args<span class="org-tuareg-font-lock-operator">,</span> children<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">licensees</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> children'</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> list_remove <span class="org-tuareg-font-lock-operator">(</span>is_licensee_of f<span class="org-tuareg-font-lock-operator">)</span> children <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">begin</span>
       <span class="org-keyword">match</span> licensees <span class="org-keyword">with</span>
       <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token2<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> children2<span class="org-tuareg-font-lock-operator">,</span> meaning2<span class="org-tuareg-font-lock-operator">)]</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
          <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token1<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Derived</span><span class="org-tuareg-font-lock-operator">,</span> alpha<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"_"</span><span class="org-tuareg-font-lock-operator">,</span> f<span class="org-tuareg-font-lock-operator">,</span> meaning2<span class="org-tuareg-font-lock-operator">)::</span>args<span class="org-tuareg-font-lock-operator">,</span> children' <span class="org-tuareg-font-lock-operator">@</span> children2<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">))</span>
       <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>
     <span class="org-tuareg-font-lock-governing">end</span>
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">merge_nonfinal</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">expr </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">expression option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">modify</span><span class="org-variable-name"> predicate func</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[]</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">[]</span>
    <span class="org-tuareg-font-lock-operator">|</span> x<span class="org-tuareg-font-lock-operator">::</span>xs <span class="org-keyword">when</span> predicate x <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">(</span>func x<span class="org-tuareg-font-lock-operator">)::</span>xs
    <span class="org-tuareg-font-lock-operator">|</span> x<span class="org-tuareg-font-lock-operator">::</span>xs <span class="org-tuareg-font-lock-operator">-&gt;</span> x<span class="org-tuareg-font-lock-operator">::</span>modify predicate func xs
  <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-keyword">match</span> expr <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token1<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensor</span> f<span class="org-tuareg-font-lock-operator">)::</span>alpha<span class="org-tuareg-font-lock-operator">,</span> args<span class="org-tuareg-font-lock-operator">,</span> children<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">licensees</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> list_remove <span class="org-tuareg-font-lock-operator">(</span>is_nonfinal_licensee_of f<span class="org-tuareg-font-lock-operator">)</span> children <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">begin</span>
       <span class="org-keyword">match</span> licensees <span class="org-keyword">with</span>
       <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token2<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> meaning2<span class="org-tuareg-font-lock-operator">)]</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
          <span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">check_feature</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
            <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span><span class="org-tuareg-font-lock-operator">(</span>r<span class="org-tuareg-font-lock-operator">,</span> k<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Licensee</span> f'<span class="org-tuareg-font-lock-operator">)::</span>gamma<span class="org-tuareg-font-lock-operator">,</span> arg<span class="org-tuareg-font-lock-operator">,</span> ch<span class="org-tuareg-font-lock-operator">,</span> mn<span class="org-tuareg-font-lock-operator">)</span> <span class="org-keyword">when</span> f <span class="org-tuareg-font-lock-operator">=</span> f' <span class="org-tuareg-font-lock-operator">-&gt;</span>
               <span class="org-tuareg-font-lock-constructor">Expr</span><span class="org-tuareg-font-lock-operator">(</span>r<span class="org-tuareg-font-lock-operator">,</span> k<span class="org-tuareg-font-lock-operator">,</span> gamma<span class="org-tuareg-font-lock-operator">,</span> arg<span class="org-tuareg-font-lock-operator">,</span> ch<span class="org-tuareg-font-lock-operator">,</span> mn<span class="org-tuareg-font-lock-operator">)</span>
            <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-builtin">failwith</span> <span class="org-string">"Could not check feature"</span> <span class="org-tuareg-font-lock-governing">in</span>
          <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">children'</span> <span class="org-tuareg-font-lock-operator">=</span> modify <span class="org-tuareg-font-lock-operator">(</span>is_nonfinal_licensee_of f<span class="org-tuareg-font-lock-operator">)</span> check_feature children <span class="org-tuareg-font-lock-governing">in</span>
          <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">inserted_meaning</span> <span class="org-tuareg-font-lock-operator">=</span>
            <span class="org-keyword">if</span> is_quantifier meaning2 <span class="org-keyword">then</span>
              <span class="org-keyword">match</span> meaning2 <span class="org-keyword">with</span>
              <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Conj</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Inti</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> i<span class="org-tuareg-font-lock-operator">))</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">Variable</span> i
              <span class="org-tuareg-font-lock-operator">|</span> _                     <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-builtin">failwith</span> <span class="org-string">"Could not insert variable in place of quantifier"</span>
            <span class="org-keyword">else</span>
              meaning2 <span class="org-tuareg-font-lock-governing">in</span>
          <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Expr</span> <span class="org-tuareg-font-lock-operator">(</span>token1<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">Derived</span><span class="org-tuareg-font-lock-operator">,</span> alpha<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">(</span>token2<span class="org-tuareg-font-lock-operator">,</span> f<span class="org-tuareg-font-lock-operator">,</span> inserted_meaning<span class="org-tuareg-font-lock-operator">)::</span>args<span class="org-tuareg-font-lock-operator">,</span> children'<span class="org-tuareg-font-lock-operator">,</span> meaning<span class="org-tuareg-font-lock-operator">))</span>
       <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>
     <span class="org-tuareg-font-lock-governing">end</span>
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">retired_of_derivation</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">LexicalEntry</span>                 <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>empty
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">DerivedEntry</span> <span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> retired<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> retired

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">merge_retired</span><span class="org-variable-name"> d1 d2</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>union <span class="org-tuareg-font-lock-operator">(</span>retired_of_derivation d1<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">(</span>retired_of_derivation d2<span class="org-tuareg-font-lock-operator">)</span>
<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">disjoint_retired</span><span class="org-variable-name"> d1 d2</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-module">RetiredSet.</span>is_empty <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>inter <span class="org-tuareg-font-lock-operator">(</span>retired_of_derivation d1<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">(</span>retired_of_derivation d2<span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">id_of_expression</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">id</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> id

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">lift_chart</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">name </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">string</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">f </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> expression option</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-type">chart_entry </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> chart_entry option</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">fun</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-variable-name">id1</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> expr1</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> deriv1</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-keyword">as</span><span class="org-variable-name"> entry1</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">retired</span> <span class="org-tuareg-font-lock-operator">=</span> retired_of_derivation deriv1 <span class="org-tuareg-font-lock-governing">in</span>
  bind_option <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">e</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
      <span class="org-keyword">if</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>mem id1 retired <span class="org-keyword">then</span>
        <span class="org-tuareg-font-lock-constructor">None</span>
      <span class="org-keyword">else</span>
        <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span>gensym <span class="org-tuareg-font-lock-operator">(),</span> e<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">DerivedEntry</span> <span class="org-tuareg-font-lock-operator">(</span>name<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span>entry1<span class="org-tuareg-font-lock-operator">],</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>add id1 retired<span class="org-tuareg-font-lock-operator">))</span>
    <span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">(</span>f expr1<span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">lift2_chart</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">name </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">string</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">f </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">expression </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> expression </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> expression option</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-type">chart_entry </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> chart_entry </span><span class="org-tuareg-font-lock-operator">-&gt;</span><span class="org-type"> chart_entry option</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">fun</span> <span class="org-tuareg-font-lock-operator">((</span><span class="org-variable-name">id1</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> expr1</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> deriv1</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-keyword">as</span><span class="org-variable-name"> entry1</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">((</span><span class="org-variable-name">id2</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> expr2</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> deriv2</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-keyword">as</span><span class="org-variable-name"> entry2</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">retired</span> <span class="org-tuareg-font-lock-operator">=</span> merge_retired deriv1 deriv2 <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">disjoint</span> <span class="org-tuareg-font-lock-operator">=</span> disjoint_retired deriv1 deriv2 <span class="org-tuareg-font-lock-governing">in</span>
  bind_option <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">e</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
      <span class="org-keyword">if</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>mem id1 retired <span class="org-tuareg-font-lock-operator">||</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>mem id2 retired <span class="org-tuareg-font-lock-operator">||</span> <span class="org-tuareg-font-lock-operator">not</span> disjoint <span class="org-keyword">then</span>
        <span class="org-tuareg-font-lock-constructor">None</span>
      <span class="org-keyword">else</span>
        <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">retired'</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>add id1 <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>add id2 retired <span class="org-tuareg-font-lock-governing">in</span>
        <span class="org-tuareg-font-lock-constructor">Some</span> <span class="org-tuareg-font-lock-operator">(</span>gensym <span class="org-tuareg-font-lock-operator">(),</span> e<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-constructor">DerivedEntry</span> <span class="org-tuareg-font-lock-operator">(</span>name<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span>entry1<span class="org-tuareg-font-lock-operator">;</span> entry2<span class="org-tuareg-font-lock-operator">],</span> retired'<span class="org-tuareg-font-lock-operator">)))</span> <span class="org-tuareg-font-lock-operator">(</span>f expr1 expr2<span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">derive_one</span><span class="org-variable-name"> grammar </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">entry </span><span class="org-tuareg-font-lock-operator">:</span><span class="org-variable-name"> </span><span class="org-type">chart_entry</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> chart</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">chart_entry list</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">keep_somes</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">function</span>
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[]</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">[]</span>
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">None</span><span class="org-tuareg-font-lock-operator">::</span>rest <span class="org-tuareg-font-lock-operator">-&gt;</span> keep_somes rest
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Some</span> x<span class="org-tuareg-font-lock-operator">)::</span>rest <span class="org-tuareg-font-lock-operator">-&gt;</span> x<span class="org-tuareg-font-lock-operator">::</span>keep_somes rest <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">merge1derivations</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[(</span>lift_chart <span class="org-string">"merge_comp"</span> merge_comp<span class="org-tuareg-font-lock-operator">)</span> entry<span class="org-tuareg-font-lock-operator">]</span> <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">merge2derivations</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[(</span>lift_chart <span class="org-string">"merge_spec"</span> merge_spec<span class="org-tuareg-font-lock-operator">)</span> entry<span class="org-tuareg-font-lock-operator">]</span> <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">merge3derivations</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[(</span>lift_chart <span class="org-string">"merge_nonfinal"</span> merge_nonfinal<span class="org-tuareg-font-lock-operator">)</span> entry<span class="org-tuareg-font-lock-operator">]</span> <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">insert_derivations</span> <span class="org-tuareg-font-lock-operator">=</span> map_chart <span class="org-tuareg-font-lock-operator">((</span>lift2_chart <span class="org-string">"insert"</span> insert<span class="org-tuareg-font-lock-operator">)</span> entry<span class="org-tuareg-font-lock-operator">)</span> chart <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">adjunct_derivations</span> <span class="org-tuareg-font-lock-operator">=</span> map_chart <span class="org-tuareg-font-lock-operator">((</span>lift2_chart <span class="org-string">"insert"</span> insert_adjunct<span class="org-tuareg-font-lock-operator">)</span> entry<span class="org-tuareg-font-lock-operator">)</span> chart <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">spellout_derivations</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[(</span>lift_chart <span class="org-string">"spellout"</span> spellout<span class="org-tuareg-font-lock-operator">)</span> entry<span class="org-tuareg-font-lock-operator">]</span> <span class="org-tuareg-font-lock-governing">in</span>
  keep_somes <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">List.</span>concat <span class="org-tuareg-font-lock-operator">[</span>
                    adjunct_derivations<span class="org-tuareg-font-lock-operator">;</span>
                    spellout_derivations<span class="org-tuareg-font-lock-operator">;</span>
                    merge1derivations<span class="org-tuareg-font-lock-operator">;</span>
                    merge2derivations<span class="org-tuareg-font-lock-operator">;</span>
                    merge3derivations<span class="org-tuareg-font-lock-operator">;</span>
                    insert_derivations<span class="org-tuareg-font-lock-operator">;</span>
                  <span class="org-tuareg-font-lock-operator">]</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">derive</span><span class="org-variable-name"> grammar expr chart</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">chart_entry option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">derivations</span> <span class="org-tuareg-font-lock-operator">=</span> derive_one grammar expr chart <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-keyword">match</span> derivations <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[]</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>
  <span class="org-tuareg-font-lock-operator">|</span> x<span class="org-tuareg-font-lock-operator">::</span>_ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">Some</span> x

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">derive_step</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">((</span><span class="org-variable-name">grammar</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> lexical_ids</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> agenda</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> chart</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-keyword">as</span><span class="org-variable-name"> state</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">parse_state</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> agenda <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[]</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> state
  <span class="org-tuareg-font-lock-operator">|</span> expr<span class="org-tuareg-font-lock-operator">::</span>agenda' <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">begin</span>
       <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">make_derivation</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">item</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> agenda</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> chart</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span>
         <span class="org-keyword">match</span> item <span class="org-keyword">with</span>
         <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">None</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">None</span><span class="org-tuareg-font-lock-operator">,</span> agenda<span class="org-tuareg-font-lock-operator">,</span> chart<span class="org-tuareg-font-lock-operator">)</span>
         <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Some</span> item <span class="org-tuareg-font-lock-operator">-&gt;</span>
            <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">derived</span> <span class="org-tuareg-font-lock-operator">=</span> derive grammar item chart <span class="org-tuareg-font-lock-governing">in</span>
            <span class="org-tuareg-font-lock-governing">begin</span>
              <span class="org-keyword">match</span> derived <span class="org-keyword">with</span>
              <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">None</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">None</span><span class="org-tuareg-font-lock-operator">,</span> agenda<span class="org-tuareg-font-lock-operator">,</span> chart<span class="org-tuareg-font-lock-operator">)</span>
              <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Some</span> derived <span class="org-tuareg-font-lock-operator">-&gt;</span>
                 <span class="org-comment-delimiter">(* </span><span class="org-comment">format_derivation Format.std_formatter derived; </span><span class="org-comment-delimiter">*)</span>
                 <span class="org-comment-delimiter">(* </span><span class="org-comment">read_line (); </span><span class="org-comment-delimiter">*)</span>
                 make_derivation <span class="org-tuareg-font-lock-operator">(</span>
                     <span class="org-tuareg-font-lock-constructor">Some</span> derived<span class="org-tuareg-font-lock-operator">,</span>
                     derived<span class="org-tuareg-font-lock-operator">::</span>agenda<span class="org-tuareg-font-lock-operator">,</span>
                     insert_chart derived chart
                   <span class="org-tuareg-font-lock-operator">)</span>
            <span class="org-tuareg-font-lock-governing">end</span>
       <span class="org-tuareg-font-lock-governing">in</span>
       <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">_</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> agenda''</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> chart'</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> make_derivation <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-constructor">Some</span> expr<span class="org-tuareg-font-lock-operator">,</span> agenda'<span class="org-tuareg-font-lock-operator">,</span> chart<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-governing">in</span>
       <span class="org-tuareg-font-lock-operator">(</span>grammar<span class="org-tuareg-font-lock-operator">,</span> lexical_ids<span class="org-tuareg-font-lock-operator">,</span> agenda''<span class="org-tuareg-font-lock-operator">,</span> chart'<span class="org-tuareg-font-lock-operator">)</span>
     <span class="org-tuareg-font-lock-governing">end</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">is_terminal</span><span class="org-variable-name"> grammar lexical_ids </span><span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">_</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> expr</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> deriv</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-keyword">match</span> expr <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Expr</span><span class="org-tuareg-font-lock-operator">(</span>_<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-tuareg-font-lock-constructor">Licensee</span> f<span class="org-tuareg-font-lock-operator">],</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">,</span> _<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">retired</span> <span class="org-tuareg-font-lock-operator">=</span> retired_of_derivation deriv <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">List.</span>exists <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">x</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> x <span class="org-tuareg-font-lock-operator">=</span> f<span class="org-tuareg-font-lock-operator">)</span> grammar.start_symbols<span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">&amp;&amp;</span>
       <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">List.</span>for_all <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">fun</span> <span class="org-variable-name">id</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-module">RetiredSet.</span>mem id retired<span class="org-tuareg-font-lock-operator">)</span> lexical_ids<span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-tuareg-font-lock-operator">|</span> _                                 <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">false</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-governing">rec</span> <span class="org-function-name">derive_all</span><span class="org-variable-name"> </span><span class="org-tuareg-font-lock-operator">((</span><span class="org-variable-name">grammar</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> lexical_ids</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> agenda</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> chart</span><span class="org-tuareg-font-lock-operator">)</span><span class="org-variable-name"> </span><span class="org-keyword">as</span><span class="org-variable-name"> state</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">parse_state</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> agenda<span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-module">ExpressionSet.</span>is_empty <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">ExpressionSet.</span>filter <span class="org-tuareg-font-lock-operator">(</span>is_terminal grammar lexical_ids<span class="org-tuareg-font-lock-operator">)</span> chart <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-operator">[],</span> _ <span class="org-tuareg-font-lock-operator">|</span> _<span class="org-tuareg-font-lock-operator">,</span> <span class="org-constant">false</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> state
  <span class="org-tuareg-font-lock-operator">|</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> derive_all <span class="org-tuareg-font-lock-operator">(</span>derive_step state<span class="org-tuareg-font-lock-operator">)</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">parse</span><span class="org-variable-name"> grammar input</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">chart_entry option</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">tokens</span>           <span class="org-tuareg-font-lock-operator">=</span> tokenize input <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">state</span>            <span class="org-tuareg-font-lock-operator">=</span> initial_state grammar tokens <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">_</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> lexical_ids</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> chart</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> derive_all state <span class="org-tuareg-font-lock-governing">in</span>
  <span class="org-keyword">try</span>
    <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">terminals</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">ExpressionSet.</span>elements <span class="org-tuareg-font-lock-operator">@@</span> <span class="org-tuareg-font-lock-module">ExpressionSet.</span>filter <span class="org-tuareg-font-lock-operator">(</span>is_terminal grammar lexical_ids<span class="org-tuareg-font-lock-operator">)</span> chart <span class="org-tuareg-font-lock-governing">in</span>
    <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">result</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-module">List.</span>hd terminals <span class="org-tuareg-font-lock-governing">in</span>
    <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">spelled</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">(</span>lift_chart <span class="org-string">"spellout"</span> spellout<span class="org-tuareg-font-lock-operator">)</span> result <span class="org-tuareg-font-lock-governing">in</span>
    <span class="org-keyword">match</span> spelled <span class="org-keyword">with</span>
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Some</span> x <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">Some</span> x
    <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">None</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">Some</span> result
  <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-builtin">Failure</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-tuareg-font-lock-constructor">None</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">recognize</span><span class="org-variable-name"> grammar input</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">bool</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> parse grammar input <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Some</span> _ <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">true</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">None</span>   <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-constant">false</span>

<span class="org-doc">(** {2 Citations}</span>

<span class="org-doc">[Kobele06]:</span>

<span class="org-doc">[Fowlie]: http://meaghanfowlie.com/documents/fowlie_mit_slides.pdf</span>

<span class="org-doc"> *)</span>
</pre>
</div>
</div>
</div>
</section>

<section id="outline-container-org101e11d" class="outline-2">
<h2 id="org101e11d"><span class="section-number-2">4</span> Examples</h2>
<div class="outline-text-2" id="text-4">
<p>
First, we define our basic grammar:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-operator">#</span>use <span class="org-string">"hunter.ml"</span><span class="org-tuareg-font-lock-operator">;;</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">basic</span> <span class="org-tuareg-font-lock-operator">:</span> <span class="org-type">grammar </span><span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">{</span>
    start_symbols <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"c"</span><span class="org-tuareg-font-lock-operator">];</span>
    lexicon <span class="org-tuareg-font-lock-operator">=</span>
      <span class="org-tuareg-font-lock-operator">[</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"alice"</span><span class="org-tuareg-font-lock-operator">,</span>     <span class="org-tuareg-font-lock-operator">[</span>lie <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">],</span>                            <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"alice"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"alice.NOM"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span>lie <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"k"</span><span class="org-tuareg-font-lock-operator">],</span>                   <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"alice"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"bob"</span><span class="org-tuareg-font-lock-operator">,</span>       <span class="org-tuareg-font-lock-operator">[</span>lie <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">],</span>                            <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"bob"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"bob.NOM"</span><span class="org-tuareg-font-lock-operator">,</span>   <span class="org-tuareg-font-lock-operator">[</span>lie <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"k"</span><span class="org-tuareg-font-lock-operator">],</span>                   <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"bob"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"some"</span><span class="org-tuareg-font-lock-operator">,</span>      <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"q"</span><span class="org-tuareg-font-lock-operator">],</span>          <span class="org-tuareg-font-lock-constructor">Quantifier</span> <span class="org-tuareg-font-lock-constructor">Exists</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"some.NOM"</span><span class="org-tuareg-font-lock-operator">,</span>  <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"k"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"q"</span><span class="org-tuareg-font-lock-operator">],</span> <span class="org-tuareg-font-lock-constructor">Quantifier</span> <span class="org-tuareg-font-lock-constructor">Exists</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"every"</span><span class="org-tuareg-font-lock-operator">,</span>     <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"q"</span><span class="org-tuareg-font-lock-operator">],</span>          <span class="org-tuareg-font-lock-constructor">Quantifier</span> <span class="org-tuareg-font-lock-constructor">Forall</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"every.NOM"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"k"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"q"</span><span class="org-tuareg-font-lock-operator">],</span> <span class="org-tuareg-font-lock-constructor">Quantifier</span> <span class="org-tuareg-font-lock-constructor">Forall</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"boy"</span><span class="org-tuareg-font-lock-operator">,</span>       <span class="org-tuareg-font-lock-operator">[</span>lie <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">],</span>                            <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"boy"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"girl"</span><span class="org-tuareg-font-lock-operator">,</span>      <span class="org-tuareg-font-lock-operator">[</span>lie <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">],</span>                            <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"girl"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"fast"</span><span class="org-tuareg-font-lock-operator">,</span>      <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">],</span>                   <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"fast"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"blonde"</span><span class="org-tuareg-font-lock-operator">,</span>    <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"n"</span><span class="org-tuareg-font-lock-operator">],</span>                   <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"blonde"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"chase"</span><span class="org-tuareg-font-lock-operator">,</span>     <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lic <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"v"</span><span class="org-tuareg-font-lock-operator">],</span>          <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"chase"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"run"</span><span class="org-tuareg-font-lock-operator">,</span>       <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"v"</span><span class="org-tuareg-font-lock-operator">],</span>                   <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"run"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"-s"</span><span class="org-tuareg-font-lock-operator">,</span>        <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"v"</span><span class="org-tuareg-font-lock-operator">;</span> lic <span class="org-string">"k"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"t"</span><span class="org-tuareg-font-lock-operator">],</span>          <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"present"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"quickly"</span><span class="org-tuareg-font-lock-operator">,</span>   <span class="org-tuareg-font-lock-operator">[</span>adj <span class="org-string">"v"</span><span class="org-tuareg-font-lock-operator">],</span>                            <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">"quick"</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"he.1.NOM"</span><span class="org-tuareg-font-lock-operator">,</span>  <span class="org-tuareg-font-lock-operator">[</span>lie <span class="org-string">"d"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"k"</span><span class="org-tuareg-font-lock-operator">],</span>                   <span class="org-tuareg-font-lock-constructor">Variable</span> 1<span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"&#949;"</span><span class="org-tuareg-font-lock-operator">,</span>         <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"t"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"c"</span><span class="org-tuareg-font-lock-operator">],</span>                   <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">""</span><span class="org-tuareg-font-lock-operator">);</span>
        <span class="org-tuareg-font-lock-operator">(</span><span class="org-string">"&#949;.Q"</span><span class="org-tuareg-font-lock-operator">,</span>       <span class="org-tuareg-font-lock-operator">[</span>lic <span class="org-string">"t"</span><span class="org-tuareg-font-lock-operator">;</span> lic <span class="org-string">"q"</span><span class="org-tuareg-font-lock-operator">;</span> lie <span class="org-string">"c"</span><span class="org-tuareg-font-lock-operator">],</span>          <span class="org-tuareg-font-lock-constructor">Constant</span> <span class="org-string">""</span><span class="org-tuareg-font-lock-operator">);</span>
      <span class="org-tuareg-font-lock-operator">];</span>
  <span class="org-tuareg-font-lock-operator">};;</span>
</pre>
</div>

<p>
Next, we define our model:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">model</span> <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">{</span>
    entities    <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"alice"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"bob"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"carol"</span><span class="org-tuareg-font-lock-operator">];</span>
    events      <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"chasing"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"running"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"alice chasing carol"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"carol chasing bob"</span><span class="org-tuareg-font-lock-operator">];</span>
    assignments <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[(</span>1<span class="org-tuareg-font-lock-operator">,</span> <span class="org-string">"bob"</span><span class="org-tuareg-font-lock-operator">)];</span>
    predicates  <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[</span>
        <span class="org-string">"present"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"chasing"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"running"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"alice chasing carol"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"carol chasing bob"</span><span class="org-tuareg-font-lock-operator">];</span>
        <span class="org-string">"chase"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"chasing"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"alice chasing carol"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"carol chasing bob"</span><span class="org-tuareg-font-lock-operator">];</span>
        <span class="org-string">"quick"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"chasing"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"alice chasing carol"</span><span class="org-tuareg-font-lock-operator">];</span>
        <span class="org-string">"run"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"running"</span><span class="org-tuareg-font-lock-operator">];</span>
        <span class="org-string">"girl"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"carol"</span><span class="org-tuareg-font-lock-operator">];</span>
        <span class="org-string">"fast"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"carol"</span><span class="org-tuareg-font-lock-operator">];</span>
      <span class="org-tuareg-font-lock-operator">];</span>
    predicates2 <span class="org-tuareg-font-lock-operator">=</span> <span class="org-tuareg-font-lock-operator">[</span>
        <span class="org-string">"int"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span><span class="org-string">"chasing"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-string">"bob"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"alice chasing carol"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-string">"carol"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-string">"carol chasing bob"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-string">"bob"</span><span class="org-tuareg-font-lock-operator">];</span>
        <span class="org-string">"ext"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-tuareg-font-lock-operator">[</span>
            <span class="org-string">"chasing"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-string">"alice"</span><span class="org-tuareg-font-lock-operator">;</span>
            <span class="org-string">"running"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-string">"alice"</span><span class="org-tuareg-font-lock-operator">;</span>
            <span class="org-string">"alice chasing carol"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-string">"alice"</span><span class="org-tuareg-font-lock-operator">;</span>
            <span class="org-string">"carol chasing bob"</span><span class="org-tuareg-font-lock-operator">,</span> <span class="org-string">"carol"</span>
          <span class="org-tuareg-font-lock-operator">]</span>
      <span class="org-tuareg-font-lock-operator">];</span>
  <span class="org-tuareg-font-lock-operator">};;</span>
</pre>
</div>

<p>
Finally, we run our test sentences:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">show_formula</span><span class="org-variable-name"> formula</span> <span class="org-tuareg-font-lock-operator">=</span>
  print_endline <span class="org-tuareg-font-lock-operator">@@</span> string_of_formula formula<span class="org-tuareg-font-lock-operator">;</span>
  <span class="org-keyword">if</span> eval model formula <span class="org-keyword">then</span>
    <span class="org-tuareg-font-lock-operator">(</span>print_endline <span class="org-string">"True"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-constant">true</span><span class="org-tuareg-font-lock-operator">)</span>
  <span class="org-keyword">else</span>
    <span class="org-tuareg-font-lock-operator">(</span>print_endline <span class="org-string">"False"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-constant">false</span><span class="org-tuareg-font-lock-operator">);;</span>

<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">show_example</span><span class="org-variable-name"> expected input</span> <span class="org-tuareg-font-lock-operator">=</span>
  <span class="org-keyword">match</span> parse basic input <span class="org-keyword">with</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">Some</span> derivation <span class="org-tuareg-font-lock-operator">-&gt;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-tuareg-font-lock-operator">(</span><span class="org-variable-name">_</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> expr</span><span class="org-tuareg-font-lock-operator">,</span><span class="org-variable-name"> _</span><span class="org-tuareg-font-lock-operator">)</span> <span class="org-tuareg-font-lock-operator">=</span> derivation <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">formula</span> <span class="org-tuareg-font-lock-operator">=</span> get_expr_meaning expr <span class="org-tuareg-font-lock-governing">in</span>
     print_endline input<span class="org-tuareg-font-lock-operator">;</span>
     format_derivation <span class="org-tuareg-font-lock-operator">(</span><span class="org-tuareg-font-lock-module">Format.</span>std_formatter<span class="org-tuareg-font-lock-operator">)</span> derivation<span class="org-tuareg-font-lock-operator">;</span>
     <span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">result</span> <span class="org-tuareg-font-lock-operator">=</span> show_formula formula <span class="org-tuareg-font-lock-governing">in</span>
     <span class="org-tuareg-font-lock-operator">(</span><span class="org-keyword">if</span> result <span class="org-tuareg-font-lock-operator">=</span> expected <span class="org-keyword">then</span>
       print_endline <span class="org-string">"PASS"</span>
      <span class="org-keyword">else</span>
        <span class="org-tuareg-font-lock-operator">(</span>print_endline <span class="org-string">"FAIL"</span><span class="org-tuareg-font-lock-operator">;</span> <span class="org-builtin">failwith</span> <span class="org-string">"Test failed"</span><span class="org-tuareg-font-lock-operator">));</span>
     print_newline <span class="org-tuareg-font-lock-operator">()</span>
  <span class="org-tuareg-font-lock-operator">|</span> <span class="org-tuareg-font-lock-constructor">None</span> <span class="org-tuareg-font-lock-operator">-&gt;</span> <span class="org-builtin">failwith</span> <span class="org-string">"Could not parse"</span><span class="org-tuareg-font-lock-operator">;;</span>


show_example <span class="org-constant">true</span>  <span class="org-string">"&#949; alice.NOM chase -s bob"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">true</span>  <span class="org-string">"&#949; alice.NOM chase -s bob quickly"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">true</span>  <span class="org-string">"&#949; alice.NOM run -s"</span><span class="org-tuareg-font-lock-operator">;;</span>

show_example <span class="org-constant">false</span> <span class="org-string">"&#949; alice.NOM run -s quickly"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">false</span> <span class="org-string">"&#949; bob.NOM chase -s alice"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">false</span> <span class="org-string">"&#949; he.1.NOM chase -s alice"</span><span class="org-tuareg-font-lock-operator">;;</span>

show_example <span class="org-constant">true</span>  <span class="org-string">"&#949;.Q alice.NOM chase -s some girl"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">true</span>  <span class="org-string">"&#949;.Q alice.NOM chase -s some fast girl"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">true</span>  <span class="org-string">"&#949;.Q alice.NOM chase -s some fast girl quickly"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">true</span>  <span class="org-string">"&#949;.Q alice.NOM chase -s every girl"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">true</span>  <span class="org-string">"&#949;.Q some.NOM girl chase -s bob"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">true</span>  <span class="org-string">"&#949;.Q every.NOM girl chase -s bob"</span><span class="org-tuareg-font-lock-operator">;;</span>

show_example <span class="org-constant">false</span> <span class="org-string">"&#949;.Q bob.NOM chase -s some girl"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">false</span> <span class="org-string">"&#949;.Q bob.NOM chase -s every girl"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">false</span> <span class="org-string">"&#949;.Q some.NOM girl chase -s alice"</span><span class="org-tuareg-font-lock-operator">;;</span>
show_example <span class="org-constant">false</span> <span class="org-string">"&#949;.Q every.NOM girl chase -s alice"</span><span class="org-tuareg-font-lock-operator">;;</span>
</pre>
</div>

<p>
The output is as follows:
</p>
<div class="org-src-container">
<pre class="src src-fundamental">&#949; alice.NOM chase -s bob
e0 = &lt;bob::-d = bob, {}&gt;
e1 = &lt;chase::+d +d -v = chase, {}&gt;
e2 = insert(e0, e1) = &lt;chase::+d +d -v = chase, {&lt;bob::-d = bob, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;chase:+d -v = chase, bob d = bob, {}&gt;
e4 = &lt;alice.NOM::-d -k = alice, {}&gt;
e5 = insert(e3, e4) = &lt;chase:+d -v = chase, bob d = bob, {&lt;alice.NOM::-d -k = alice, {}&gt;}&gt;
e6 = merge_nonfinal(e5) = &lt;chase:-v = chase, alice.NOM d = alice, bob d = bob, {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e7 = spellout(e6) = &lt;alice.NOM chase bob:-v = chase &amp; int(bob) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e8 = &lt;-s::+v +k -t = present, {}&gt;
e9 = insert(e7, e8) = &lt;-s::+v +k -t = present, {&lt;alice.NOM chase bob:-v = chase &amp; int(bob) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;}&gt;
e10 = merge_comp(e9) = &lt;-s:+k -t = present, alice.NOM chase bob v = chase &amp; int(bob) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e11 = merge_spec(e10) = &lt;-s:-t = present, _ k = alice, alice.NOM chase bob v = chase &amp; int(bob) &amp; ext(alice), {}&gt;
e12 = spellout(e11) = &lt;_ -s alice.NOM chase bob:-t = &lt;present &amp; chase &amp; int(bob) &amp; ext(alice)&gt;, {}&gt;
e13 = &lt;&#949;::+t -c = , {}&gt;
e14 = insert(e12, e13) = &lt;&#949;::+t -c = , {&lt;_ -s alice.NOM chase bob:-t = &lt;present &amp; chase &amp; int(bob) &amp; ext(alice)&gt;, {}&gt;}&gt;
e15 = merge_comp(e14) = &lt;&#949;:-c = , _ -s alice.NOM chase bob t = &lt;present &amp; chase &amp; int(bob) &amp; ext(alice)&gt;, {}&gt;
e16 = spellout(e15) = &lt;_ -s alice.NOM chase bob:-c = &lt;present &amp; chase &amp; int(bob) &amp; ext(alice)&gt;, {}&gt;
&lt;present &amp; chase &amp; int(bob) &amp; ext(alice)&gt;
True
PASS

&#949; alice.NOM chase -s bob quickly
e0 = &lt;bob::-d = bob, {}&gt;
e1 = &lt;chase::+d +d -v = chase, {}&gt;
e2 = insert(e0, e1) = &lt;chase::+d +d -v = chase, {&lt;bob::-d = bob, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;chase:+d -v = chase, bob d = bob, {}&gt;
e4 = &lt;alice.NOM::-d -k = alice, {}&gt;
e5 = insert(e3, e4) = &lt;chase:+d -v = chase, bob d = bob, {&lt;alice.NOM::-d -k = alice, {}&gt;}&gt;
e6 = merge_nonfinal(e5) = &lt;chase:-v = chase, alice.NOM d = alice, bob d = bob, {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e7 = &lt;quickly::*v = quick, {}&gt;
e8 = insert(e6, e7) = &lt;chase:-v = chase, alice.NOM d = alice, bob d = bob, {&lt;quickly::*v = quick, {}&gt;, &lt;alice.NOM::-k = alice, {}&gt;}&gt;
e9 = spellout(e8) = &lt;alice.NOM chase bob quickly:-v = quick &amp; chase &amp; int(bob) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e10 = &lt;-s::+v +k -t = present, {}&gt;
e11 = insert(e9, e10) = &lt;-s::+v +k -t = present, {&lt;alice.NOM chase bob quickly:-v = quick &amp; chase &amp; int(bob) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;}&gt;
e12 = merge_comp(e11) = &lt;-s:+k -t = present, alice.NOM chase bob quickly v = quick &amp; chase &amp; int(bob) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e13 = merge_spec(e12) = &lt;-s:-t = present, _ k = alice, alice.NOM chase bob quickly v = quick &amp; chase &amp; int(bob) &amp; ext(alice), {}&gt;
e14 = spellout(e13) = &lt;_ -s alice.NOM chase bob quickly:-t = &lt;present &amp; quick &amp; chase &amp; int(bob) &amp; ext(alice)&gt;, {}&gt;
e15 = &lt;&#949;::+t -c = , {}&gt;
e16 = insert(e14, e15) = &lt;&#949;::+t -c = , {&lt;_ -s alice.NOM chase bob quickly:-t = &lt;present &amp; quick &amp; chase &amp; int(bob) &amp; ext(alice)&gt;, {}&gt;}&gt;
e17 = merge_comp(e16) = &lt;&#949;:-c = , _ -s alice.NOM chase bob quickly t = &lt;present &amp; quick &amp; chase &amp; int(bob) &amp; ext(alice)&gt;, {}&gt;
e18 = spellout(e17) = &lt;_ -s alice.NOM chase bob quickly:-c = &lt;present &amp; quick &amp; chase &amp; int(bob) &amp; ext(alice)&gt;, {}&gt;
&lt;present &amp; quick &amp; chase &amp; int(bob) &amp; ext(alice)&gt;
True
PASS

&#949; alice.NOM run -s
e0 = &lt;run::+d -v = run, {}&gt;
e1 = &lt;alice.NOM::-d -k = alice, {}&gt;
e2 = insert(e0, e1) = &lt;run::+d -v = run, {&lt;alice.NOM::-d -k = alice, {}&gt;}&gt;
e3 = merge_nonfinal(e2) = &lt;run:-v = run, alice.NOM d = alice, {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e4 = spellout(e3) = &lt;alice.NOM run:-v = run &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e5 = &lt;-s::+v +k -t = present, {}&gt;
e6 = insert(e4, e5) = &lt;-s::+v +k -t = present, {&lt;alice.NOM run:-v = run &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;}&gt;
e7 = merge_comp(e6) = &lt;-s:+k -t = present, alice.NOM run v = run &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e8 = merge_spec(e7) = &lt;-s:-t = present, _ k = alice, alice.NOM run v = run &amp; ext(alice), {}&gt;
e9 = spellout(e8) = &lt;_ -s alice.NOM run:-t = &lt;present &amp; run &amp; ext(alice)&gt;, {}&gt;
e10 = &lt;&#949;::+t -c = , {}&gt;
e11 = insert(e9, e10) = &lt;&#949;::+t -c = , {&lt;_ -s alice.NOM run:-t = &lt;present &amp; run &amp; ext(alice)&gt;, {}&gt;}&gt;
e12 = merge_comp(e11) = &lt;&#949;:-c = , _ -s alice.NOM run t = &lt;present &amp; run &amp; ext(alice)&gt;, {}&gt;
e13 = spellout(e12) = &lt;_ -s alice.NOM run:-c = &lt;present &amp; run &amp; ext(alice)&gt;, {}&gt;
&lt;present &amp; run &amp; ext(alice)&gt;
True
PASS

&#949; alice.NOM run -s quickly
e0 = &lt;run::+d -v = run, {}&gt;
e1 = &lt;alice.NOM::-d -k = alice, {}&gt;
e2 = insert(e0, e1) = &lt;run::+d -v = run, {&lt;alice.NOM::-d -k = alice, {}&gt;}&gt;
e3 = merge_nonfinal(e2) = &lt;run:-v = run, alice.NOM d = alice, {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e4 = &lt;quickly::*v = quick, {}&gt;
e5 = insert(e3, e4) = &lt;run:-v = run, alice.NOM d = alice, {&lt;quickly::*v = quick, {}&gt;, &lt;alice.NOM::-k = alice, {}&gt;}&gt;
e6 = spellout(e5) = &lt;alice.NOM run quickly:-v = quick &amp; run &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e7 = &lt;-s::+v +k -t = present, {}&gt;
e8 = insert(e6, e7) = &lt;-s::+v +k -t = present, {&lt;alice.NOM run quickly:-v = quick &amp; run &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;}&gt;
e9 = merge_comp(e8) = &lt;-s:+k -t = present, alice.NOM run quickly v = quick &amp; run &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;}&gt;
e10 = merge_spec(e9) = &lt;-s:-t = present, _ k = alice, alice.NOM run quickly v = quick &amp; run &amp; ext(alice), {}&gt;
e11 = spellout(e10) = &lt;_ -s alice.NOM run quickly:-t = &lt;present &amp; quick &amp; run &amp; ext(alice)&gt;, {}&gt;
e12 = &lt;&#949;::+t -c = , {}&gt;
e13 = insert(e11, e12) = &lt;&#949;::+t -c = , {&lt;_ -s alice.NOM run quickly:-t = &lt;present &amp; quick &amp; run &amp; ext(alice)&gt;, {}&gt;}&gt;
e14 = merge_comp(e13) = &lt;&#949;:-c = , _ -s alice.NOM run quickly t = &lt;present &amp; quick &amp; run &amp; ext(alice)&gt;, {}&gt;
e15 = spellout(e14) = &lt;_ -s alice.NOM run quickly:-c = &lt;present &amp; quick &amp; run &amp; ext(alice)&gt;, {}&gt;
&lt;present &amp; quick &amp; run &amp; ext(alice)&gt;
False
PASS

&#949; bob.NOM chase -s alice
e0 = &lt;alice::-d = alice, {}&gt;
e1 = &lt;chase::+d +d -v = chase, {}&gt;
e2 = insert(e0, e1) = &lt;chase::+d +d -v = chase, {&lt;alice::-d = alice, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;chase:+d -v = chase, alice d = alice, {}&gt;
e4 = &lt;bob.NOM::-d -k = bob, {}&gt;
e5 = insert(e3, e4) = &lt;chase:+d -v = chase, alice d = alice, {&lt;bob.NOM::-d -k = bob, {}&gt;}&gt;
e6 = merge_nonfinal(e5) = &lt;chase:-v = chase, bob.NOM d = bob, alice d = alice, {&lt;bob.NOM::-k = bob, {}&gt;}&gt;
e7 = spellout(e6) = &lt;bob.NOM chase alice:-v = chase &amp; int(alice) &amp; ext(bob), {&lt;bob.NOM::-k = bob, {}&gt;}&gt;
e8 = &lt;-s::+v +k -t = present, {}&gt;
e9 = insert(e7, e8) = &lt;-s::+v +k -t = present, {&lt;bob.NOM chase alice:-v = chase &amp; int(alice) &amp; ext(bob), {&lt;bob.NOM::-k = bob, {}&gt;}&gt;}&gt;
e10 = merge_comp(e9) = &lt;-s:+k -t = present, bob.NOM chase alice v = chase &amp; int(alice) &amp; ext(bob), {&lt;bob.NOM::-k = bob, {}&gt;}&gt;
e11 = merge_spec(e10) = &lt;-s:-t = present, _ k = bob, bob.NOM chase alice v = chase &amp; int(alice) &amp; ext(bob), {}&gt;
e12 = spellout(e11) = &lt;_ -s bob.NOM chase alice:-t = &lt;present &amp; chase &amp; int(alice) &amp; ext(bob)&gt;, {}&gt;
e13 = &lt;&#949;::+t -c = , {}&gt;
e14 = insert(e12, e13) = &lt;&#949;::+t -c = , {&lt;_ -s bob.NOM chase alice:-t = &lt;present &amp; chase &amp; int(alice) &amp; ext(bob)&gt;, {}&gt;}&gt;
e15 = merge_comp(e14) = &lt;&#949;:-c = , _ -s bob.NOM chase alice t = &lt;present &amp; chase &amp; int(alice) &amp; ext(bob)&gt;, {}&gt;
e16 = spellout(e15) = &lt;_ -s bob.NOM chase alice:-c = &lt;present &amp; chase &amp; int(alice) &amp; ext(bob)&gt;, {}&gt;
&lt;present &amp; chase &amp; int(alice) &amp; ext(bob)&gt;
False
PASS

&#949; he.1.NOM chase -s alice
e0 = &lt;alice::-d = alice, {}&gt;
e1 = &lt;chase::+d +d -v = chase, {}&gt;
e2 = insert(e0, e1) = &lt;chase::+d +d -v = chase, {&lt;alice::-d = alice, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;chase:+d -v = chase, alice d = alice, {}&gt;
e4 = &lt;he.1.NOM::-d -k = x_1, {}&gt;
e5 = insert(e3, e4) = &lt;chase:+d -v = chase, alice d = alice, {&lt;he.1.NOM::-d -k = x_1, {}&gt;}&gt;
e6 = merge_nonfinal(e5) = &lt;chase:-v = chase, he.1.NOM d = x_1, alice d = alice, {&lt;he.1.NOM::-k = x_1, {}&gt;}&gt;
e7 = spellout(e6) = &lt;he.1.NOM chase alice:-v = chase &amp; int(alice) &amp; ext(x_1), {&lt;he.1.NOM::-k = x_1, {}&gt;}&gt;
e8 = &lt;-s::+v +k -t = present, {}&gt;
e9 = insert(e7, e8) = &lt;-s::+v +k -t = present, {&lt;he.1.NOM chase alice:-v = chase &amp; int(alice) &amp; ext(x_1), {&lt;he.1.NOM::-k = x_1, {}&gt;}&gt;}&gt;
e10 = merge_comp(e9) = &lt;-s:+k -t = present, he.1.NOM chase alice v = chase &amp; int(alice) &amp; ext(x_1), {&lt;he.1.NOM::-k = x_1, {}&gt;}&gt;
e11 = merge_spec(e10) = &lt;-s:-t = present, _ k = x_1, he.1.NOM chase alice v = chase &amp; int(alice) &amp; ext(x_1), {}&gt;
e12 = spellout(e11) = &lt;_ -s he.1.NOM chase alice:-t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_1)&gt;, {}&gt;
e13 = &lt;&#949;::+t -c = , {}&gt;
e14 = insert(e12, e13) = &lt;&#949;::+t -c = , {&lt;_ -s he.1.NOM chase alice:-t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_1)&gt;, {}&gt;}&gt;
e15 = merge_comp(e14) = &lt;&#949;:-c = , _ -s he.1.NOM chase alice t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_1)&gt;, {}&gt;
e16 = spellout(e15) = &lt;_ -s he.1.NOM chase alice:-c = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_1)&gt;, {}&gt;
&lt;present &amp; chase &amp; int(alice) &amp; ext(x_1)&gt;
False
PASS

&#949;.Q alice.NOM chase -s some girl
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;some::+n -d -q = some, {}&gt;
e2 = insert(e0, e1) = &lt;some::+n -d -q = some, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;some:-d -q = some, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;some girl:-d -q = some &amp; int_-1(girl), {}&gt;
e5 = &lt;chase::+d +d -v = chase, {}&gt;
e6 = insert(e4, e5) = &lt;chase::+d +d -v = chase, {&lt;some girl:-d -q = some &amp; int_-1(girl), {}&gt;}&gt;
e7 = merge_nonfinal(e6) = &lt;chase:+d -v = chase, some girl d = x_-1, {&lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;
e8 = &lt;alice.NOM::-d -k = alice, {}&gt;
e9 = insert(e7, e8) = &lt;chase:+d -v = chase, some girl d = x_-1, {&lt;alice.NOM::-d -k = alice, {}&gt;, &lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;
e10 = merge_nonfinal(e9) = &lt;chase:-v = chase, alice.NOM d = alice, some girl d = x_-1, {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;
e11 = spellout(e10) = &lt;alice.NOM chase some girl:-v = chase &amp; int(x_-1) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;
e12 = &lt;-s::+v +k -t = present, {}&gt;
e13 = insert(e11, e12) = &lt;-s::+v +k -t = present, {&lt;alice.NOM chase some girl:-v = chase &amp; int(x_-1) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;}&gt;
e14 = merge_comp(e13) = &lt;-s:+k -t = present, alice.NOM chase some girl v = chase &amp; int(x_-1) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;
e15 = merge_spec(e14) = &lt;-s:-t = present, _ k = alice, alice.NOM chase some girl v = chase &amp; int(x_-1) &amp; ext(alice), {&lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;
e16 = spellout(e15) = &lt;_ -s alice.NOM chase some girl:-t = &lt;present &amp; chase &amp; int(x_-1) &amp; ext(alice)&gt;, {&lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;
e17 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e18 = insert(e16, e17) = &lt;&#949;.Q::+t +q -c = , {&lt;_ -s alice.NOM chase some girl:-t = &lt;present &amp; chase &amp; int(x_-1) &amp; ext(alice)&gt;, {&lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;}&gt;
e19 = merge_comp(e18) = &lt;&#949;.Q:+q -c = , _ -s alice.NOM chase some girl t = &lt;present &amp; chase &amp; int(x_-1) &amp; ext(alice)&gt;, {&lt;some girl:-q = some &amp; int_-1(girl), {}&gt;}&gt;
e20 = merge_spec(e19) = &lt;&#949;.Q:-c = , _ q = some &amp; int_-1(girl), _ -s alice.NOM chase some girl t = &lt;present &amp; chase &amp; int(x_-1) &amp; ext(alice)&gt;, {}&gt;
e21 = spellout(e20) = &lt;_ -s alice.NOM chase some girl:-c = some &amp; int_-1(girl) &amp; &lt;present &amp; chase &amp; int(x_-1) &amp; ext(alice)&gt;, {}&gt;
some &amp; int_-1(girl) &amp; &lt;present &amp; chase &amp; int(x_-1) &amp; ext(alice)&gt;
True
PASS

&#949;.Q alice.NOM chase -s some fast girl
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;fast::+n -n = fast, {}&gt;
e2 = insert(e0, e1) = &lt;fast::+n -n = fast, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;fast:-n = fast, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;fast girl:-n = fast &amp; girl, {}&gt;
e5 = &lt;some::+n -d -q = some, {}&gt;
e6 = insert(e4, e5) = &lt;some::+n -d -q = some, {&lt;fast girl:-n = fast &amp; girl, {}&gt;}&gt;
e7 = merge_comp(e6) = &lt;some:-d -q = some, fast girl n = fast &amp; girl, {}&gt;
e8 = spellout(e7) = &lt;some fast girl:-d -q = some &amp; int_-2(fast &amp; girl), {}&gt;
e9 = &lt;chase::+d +d -v = chase, {}&gt;
e10 = insert(e8, e9) = &lt;chase::+d +d -v = chase, {&lt;some fast girl:-d -q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;
e11 = merge_nonfinal(e10) = &lt;chase:+d -v = chase, some fast girl d = x_-2, {&lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;
e12 = &lt;alice.NOM::-d -k = alice, {}&gt;
e13 = insert(e11, e12) = &lt;chase:+d -v = chase, some fast girl d = x_-2, {&lt;alice.NOM::-d -k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;
e14 = merge_nonfinal(e13) = &lt;chase:-v = chase, alice.NOM d = alice, some fast girl d = x_-2, {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;
e15 = spellout(e14) = &lt;alice.NOM chase some fast girl:-v = chase &amp; int(x_-2) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;
e16 = &lt;-s::+v +k -t = present, {}&gt;
e17 = insert(e15, e16) = &lt;-s::+v +k -t = present, {&lt;alice.NOM chase some fast girl:-v = chase &amp; int(x_-2) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;}&gt;
e18 = merge_comp(e17) = &lt;-s:+k -t = present, alice.NOM chase some fast girl v = chase &amp; int(x_-2) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;
e19 = merge_spec(e18) = &lt;-s:-t = present, _ k = alice, alice.NOM chase some fast girl v = chase &amp; int(x_-2) &amp; ext(alice), {&lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;
e20 = spellout(e19) = &lt;_ -s alice.NOM chase some fast girl:-t = &lt;present &amp; chase &amp; int(x_-2) &amp; ext(alice)&gt;, {&lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;
e21 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e22 = insert(e20, e21) = &lt;&#949;.Q::+t +q -c = , {&lt;_ -s alice.NOM chase some fast girl:-t = &lt;present &amp; chase &amp; int(x_-2) &amp; ext(alice)&gt;, {&lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;}&gt;
e23 = merge_comp(e22) = &lt;&#949;.Q:+q -c = , _ -s alice.NOM chase some fast girl t = &lt;present &amp; chase &amp; int(x_-2) &amp; ext(alice)&gt;, {&lt;some fast girl:-q = some &amp; int_-2(fast &amp; girl), {}&gt;}&gt;
e24 = merge_spec(e23) = &lt;&#949;.Q:-c = , _ q = some &amp; int_-2(fast &amp; girl), _ -s alice.NOM chase some fast girl t = &lt;present &amp; chase &amp; int(x_-2) &amp; ext(alice)&gt;, {}&gt;
e25 = spellout(e24) = &lt;_ -s alice.NOM chase some fast girl:-c = some &amp; int_-2(fast &amp; girl) &amp; &lt;present &amp; chase &amp; int(x_-2) &amp; ext(alice)&gt;, {}&gt;
some &amp; int_-2(fast &amp; girl) &amp; &lt;present &amp; chase &amp; int(x_-2) &amp; ext(alice)&gt;
True
PASS

&#949;.Q alice.NOM chase -s some fast girl quickly
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;fast::+n -n = fast, {}&gt;
e2 = insert(e0, e1) = &lt;fast::+n -n = fast, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;fast:-n = fast, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;fast girl:-n = fast &amp; girl, {}&gt;
e5 = &lt;some::+n -d -q = some, {}&gt;
e6 = insert(e4, e5) = &lt;some::+n -d -q = some, {&lt;fast girl:-n = fast &amp; girl, {}&gt;}&gt;
e7 = merge_comp(e6) = &lt;some:-d -q = some, fast girl n = fast &amp; girl, {}&gt;
e8 = spellout(e7) = &lt;some fast girl:-d -q = some &amp; int_-3(fast &amp; girl), {}&gt;
e9 = &lt;chase::+d +d -v = chase, {}&gt;
e10 = insert(e8, e9) = &lt;chase::+d +d -v = chase, {&lt;some fast girl:-d -q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e11 = merge_nonfinal(e10) = &lt;chase:+d -v = chase, some fast girl d = x_-3, {&lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e12 = &lt;alice.NOM::-d -k = alice, {}&gt;
e13 = insert(e11, e12) = &lt;chase:+d -v = chase, some fast girl d = x_-3, {&lt;alice.NOM::-d -k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e14 = merge_nonfinal(e13) = &lt;chase:-v = chase, alice.NOM d = alice, some fast girl d = x_-3, {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e15 = &lt;quickly::*v = quick, {}&gt;
e16 = insert(e14, e15) = &lt;chase:-v = chase, alice.NOM d = alice, some fast girl d = x_-3, {&lt;quickly::*v = quick, {}&gt;, &lt;alice.NOM::-k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e17 = spellout(e16) = &lt;alice.NOM chase some fast girl quickly:-v = quick &amp; chase &amp; int(x_-3) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e18 = &lt;-s::+v +k -t = present, {}&gt;
e19 = insert(e17, e18) = &lt;-s::+v +k -t = present, {&lt;alice.NOM chase some fast girl quickly:-v = quick &amp; chase &amp; int(x_-3) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;}&gt;
e20 = merge_comp(e19) = &lt;-s:+k -t = present, alice.NOM chase some fast girl quickly v = quick &amp; chase &amp; int(x_-3) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e21 = merge_spec(e20) = &lt;-s:-t = present, _ k = alice, alice.NOM chase some fast girl quickly v = quick &amp; chase &amp; int(x_-3) &amp; ext(alice), {&lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e22 = spellout(e21) = &lt;_ -s alice.NOM chase some fast girl quickly:-t = &lt;present &amp; quick &amp; chase &amp; int(x_-3) &amp; ext(alice)&gt;, {&lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e23 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e24 = insert(e22, e23) = &lt;&#949;.Q::+t +q -c = , {&lt;_ -s alice.NOM chase some fast girl quickly:-t = &lt;present &amp; quick &amp; chase &amp; int(x_-3) &amp; ext(alice)&gt;, {&lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;}&gt;
e25 = merge_comp(e24) = &lt;&#949;.Q:+q -c = , _ -s alice.NOM chase some fast girl quickly t = &lt;present &amp; quick &amp; chase &amp; int(x_-3) &amp; ext(alice)&gt;, {&lt;some fast girl:-q = some &amp; int_-3(fast &amp; girl), {}&gt;}&gt;
e26 = merge_spec(e25) = &lt;&#949;.Q:-c = , _ q = some &amp; int_-3(fast &amp; girl), _ -s alice.NOM chase some fast girl quickly t = &lt;present &amp; quick &amp; chase &amp; int(x_-3) &amp; ext(alice)&gt;, {}&gt;
e27 = spellout(e26) = &lt;_ -s alice.NOM chase some fast girl quickly:-c = some &amp; int_-3(fast &amp; girl) &amp; &lt;present &amp; quick &amp; chase &amp; int(x_-3) &amp; ext(alice)&gt;, {}&gt;
some &amp; int_-3(fast &amp; girl) &amp; &lt;present &amp; quick &amp; chase &amp; int(x_-3) &amp; ext(alice)&gt;
True
PASS

&#949;.Q alice.NOM chase -s every girl
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;every::+n -d -q = every, {}&gt;
e2 = insert(e0, e1) = &lt;every::+n -d -q = every, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;every:-d -q = every, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;every girl:-d -q = every &amp; int_-4(girl), {}&gt;
e5 = &lt;chase::+d +d -v = chase, {}&gt;
e6 = insert(e4, e5) = &lt;chase::+d +d -v = chase, {&lt;every girl:-d -q = every &amp; int_-4(girl), {}&gt;}&gt;
e7 = merge_nonfinal(e6) = &lt;chase:+d -v = chase, every girl d = x_-4, {&lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;
e8 = &lt;alice.NOM::-d -k = alice, {}&gt;
e9 = insert(e7, e8) = &lt;chase:+d -v = chase, every girl d = x_-4, {&lt;alice.NOM::-d -k = alice, {}&gt;, &lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;
e10 = merge_nonfinal(e9) = &lt;chase:-v = chase, alice.NOM d = alice, every girl d = x_-4, {&lt;alice.NOM::-k = alice, {}&gt;, &lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;
e11 = spellout(e10) = &lt;alice.NOM chase every girl:-v = chase &amp; int(x_-4) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;
e12 = &lt;-s::+v +k -t = present, {}&gt;
e13 = insert(e11, e12) = &lt;-s::+v +k -t = present, {&lt;alice.NOM chase every girl:-v = chase &amp; int(x_-4) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;}&gt;
e14 = merge_comp(e13) = &lt;-s:+k -t = present, alice.NOM chase every girl v = chase &amp; int(x_-4) &amp; ext(alice), {&lt;alice.NOM::-k = alice, {}&gt;, &lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;
e15 = merge_spec(e14) = &lt;-s:-t = present, _ k = alice, alice.NOM chase every girl v = chase &amp; int(x_-4) &amp; ext(alice), {&lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;
e16 = spellout(e15) = &lt;_ -s alice.NOM chase every girl:-t = &lt;present &amp; chase &amp; int(x_-4) &amp; ext(alice)&gt;, {&lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;
e17 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e18 = insert(e16, e17) = &lt;&#949;.Q::+t +q -c = , {&lt;_ -s alice.NOM chase every girl:-t = &lt;present &amp; chase &amp; int(x_-4) &amp; ext(alice)&gt;, {&lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;}&gt;
e19 = merge_comp(e18) = &lt;&#949;.Q:+q -c = , _ -s alice.NOM chase every girl t = &lt;present &amp; chase &amp; int(x_-4) &amp; ext(alice)&gt;, {&lt;every girl:-q = every &amp; int_-4(girl), {}&gt;}&gt;
e20 = merge_spec(e19) = &lt;&#949;.Q:-c = , _ q = every &amp; int_-4(girl), _ -s alice.NOM chase every girl t = &lt;present &amp; chase &amp; int(x_-4) &amp; ext(alice)&gt;, {}&gt;
e21 = spellout(e20) = &lt;_ -s alice.NOM chase every girl:-c = every &amp; int_-4(girl) &amp; &lt;present &amp; chase &amp; int(x_-4) &amp; ext(alice)&gt;, {}&gt;
every &amp; int_-4(girl) &amp; &lt;present &amp; chase &amp; int(x_-4) &amp; ext(alice)&gt;
True
PASS

&#949;.Q some.NOM girl chase -s bob
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;some.NOM::+n -d -k -q = some, {}&gt;
e2 = insert(e0, e1) = &lt;some.NOM::+n -d -k -q = some, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;some.NOM:-d -k -q = some, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;some.NOM girl:-d -k -q = some &amp; int_-5(girl), {}&gt;
e5 = &lt;chase::+d +d -v = chase, {}&gt;
e6 = &lt;bob::-d = bob, {}&gt;
e7 = insert(e5, e6) = &lt;chase::+d +d -v = chase, {&lt;bob::-d = bob, {}&gt;}&gt;
e8 = merge_comp(e7) = &lt;chase:+d -v = chase, bob d = bob, {}&gt;
e9 = insert(e4, e8) = &lt;chase:+d -v = chase, bob d = bob, {&lt;some.NOM girl:-d -k -q = some &amp; int_-5(girl), {}&gt;}&gt;
e10 = merge_nonfinal(e9) = &lt;chase:-v = chase, some.NOM girl d = x_-5, bob d = bob, {&lt;some.NOM girl:-k -q = some &amp; int_-5(girl), {}&gt;}&gt;
e11 = spellout(e10) = &lt;some.NOM girl chase bob:-v = chase &amp; int(bob) &amp; ext(x_-5), {&lt;some.NOM girl:-k -q = some &amp; int_-5(girl), {}&gt;}&gt;
e12 = &lt;-s::+v +k -t = present, {}&gt;
e13 = insert(e11, e12) = &lt;-s::+v +k -t = present, {&lt;some.NOM girl chase bob:-v = chase &amp; int(bob) &amp; ext(x_-5), {&lt;some.NOM girl:-k -q = some &amp; int_-5(girl), {}&gt;}&gt;}&gt;
e14 = merge_comp(e13) = &lt;-s:+k -t = present, some.NOM girl chase bob v = chase &amp; int(bob) &amp; ext(x_-5), {&lt;some.NOM girl:-k -q = some &amp; int_-5(girl), {}&gt;}&gt;
e15 = merge_nonfinal(e14) = &lt;-s:-t = present, some.NOM girl k = x_-5, some.NOM girl chase bob v = chase &amp; int(bob) &amp; ext(x_-5), {&lt;some.NOM girl:-q = some &amp; int_-5(girl), {}&gt;}&gt;
e16 = spellout(e15) = &lt;some.NOM girl -s some.NOM girl chase bob:-t = &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-5)&gt;, {&lt;some.NOM girl:-q = some &amp; int_-5(girl), {}&gt;}&gt;
e17 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e18 = insert(e16, e17) = &lt;&#949;.Q::+t +q -c = , {&lt;some.NOM girl -s some.NOM girl chase bob:-t = &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-5)&gt;, {&lt;some.NOM girl:-q = some &amp; int_-5(girl), {}&gt;}&gt;}&gt;
e19 = merge_comp(e18) = &lt;&#949;.Q:+q -c = , some.NOM girl -s some.NOM girl chase bob t = &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-5)&gt;, {&lt;some.NOM girl:-q = some &amp; int_-5(girl), {}&gt;}&gt;
e20 = merge_spec(e19) = &lt;&#949;.Q:-c = , _ q = some &amp; int_-5(girl), some.NOM girl -s some.NOM girl chase bob t = &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-5)&gt;, {}&gt;
e21 = spellout(e20) = &lt;some.NOM girl -s some.NOM girl chase bob:-c = some &amp; int_-5(girl) &amp; &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-5)&gt;, {}&gt;
some &amp; int_-5(girl) &amp; &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-5)&gt;
True
PASS

&#949;.Q every.NOM girl chase -s bob
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;every.NOM::+n -d -k -q = every, {}&gt;
e2 = insert(e0, e1) = &lt;every.NOM::+n -d -k -q = every, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;every.NOM:-d -k -q = every, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;every.NOM girl:-d -k -q = every &amp; int_-6(girl), {}&gt;
e5 = &lt;chase::+d +d -v = chase, {}&gt;
e6 = &lt;bob::-d = bob, {}&gt;
e7 = insert(e5, e6) = &lt;chase::+d +d -v = chase, {&lt;bob::-d = bob, {}&gt;}&gt;
e8 = merge_comp(e7) = &lt;chase:+d -v = chase, bob d = bob, {}&gt;
e9 = insert(e4, e8) = &lt;chase:+d -v = chase, bob d = bob, {&lt;every.NOM girl:-d -k -q = every &amp; int_-6(girl), {}&gt;}&gt;
e10 = merge_nonfinal(e9) = &lt;chase:-v = chase, every.NOM girl d = x_-6, bob d = bob, {&lt;every.NOM girl:-k -q = every &amp; int_-6(girl), {}&gt;}&gt;
e11 = spellout(e10) = &lt;every.NOM girl chase bob:-v = chase &amp; int(bob) &amp; ext(x_-6), {&lt;every.NOM girl:-k -q = every &amp; int_-6(girl), {}&gt;}&gt;
e12 = &lt;-s::+v +k -t = present, {}&gt;
e13 = insert(e11, e12) = &lt;-s::+v +k -t = present, {&lt;every.NOM girl chase bob:-v = chase &amp; int(bob) &amp; ext(x_-6), {&lt;every.NOM girl:-k -q = every &amp; int_-6(girl), {}&gt;}&gt;}&gt;
e14 = merge_comp(e13) = &lt;-s:+k -t = present, every.NOM girl chase bob v = chase &amp; int(bob) &amp; ext(x_-6), {&lt;every.NOM girl:-k -q = every &amp; int_-6(girl), {}&gt;}&gt;
e15 = merge_nonfinal(e14) = &lt;-s:-t = present, every.NOM girl k = x_-6, every.NOM girl chase bob v = chase &amp; int(bob) &amp; ext(x_-6), {&lt;every.NOM girl:-q = every &amp; int_-6(girl), {}&gt;}&gt;
e16 = spellout(e15) = &lt;every.NOM girl -s every.NOM girl chase bob:-t = &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-6)&gt;, {&lt;every.NOM girl:-q = every &amp; int_-6(girl), {}&gt;}&gt;
e17 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e18 = insert(e16, e17) = &lt;&#949;.Q::+t +q -c = , {&lt;every.NOM girl -s every.NOM girl chase bob:-t = &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-6)&gt;, {&lt;every.NOM girl:-q = every &amp; int_-6(girl), {}&gt;}&gt;}&gt;
e19 = merge_comp(e18) = &lt;&#949;.Q:+q -c = , every.NOM girl -s every.NOM girl chase bob t = &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-6)&gt;, {&lt;every.NOM girl:-q = every &amp; int_-6(girl), {}&gt;}&gt;
e20 = merge_spec(e19) = &lt;&#949;.Q:-c = , _ q = every &amp; int_-6(girl), every.NOM girl -s every.NOM girl chase bob t = &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-6)&gt;, {}&gt;
e21 = spellout(e20) = &lt;every.NOM girl -s every.NOM girl chase bob:-c = every &amp; int_-6(girl) &amp; &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-6)&gt;, {}&gt;
every &amp; int_-6(girl) &amp; &lt;present &amp; chase &amp; int(bob) &amp; ext(x_-6)&gt;
True
PASS

&#949;.Q bob.NOM chase -s some girl
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;some::+n -d -q = some, {}&gt;
e2 = insert(e0, e1) = &lt;some::+n -d -q = some, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;some:-d -q = some, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;some girl:-d -q = some &amp; int_-7(girl), {}&gt;
e5 = &lt;chase::+d +d -v = chase, {}&gt;
e6 = insert(e4, e5) = &lt;chase::+d +d -v = chase, {&lt;some girl:-d -q = some &amp; int_-7(girl), {}&gt;}&gt;
e7 = merge_nonfinal(e6) = &lt;chase:+d -v = chase, some girl d = x_-7, {&lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;
e8 = &lt;bob.NOM::-d -k = bob, {}&gt;
e9 = insert(e7, e8) = &lt;chase:+d -v = chase, some girl d = x_-7, {&lt;bob.NOM::-d -k = bob, {}&gt;, &lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;
e10 = merge_nonfinal(e9) = &lt;chase:-v = chase, bob.NOM d = bob, some girl d = x_-7, {&lt;bob.NOM::-k = bob, {}&gt;, &lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;
e11 = spellout(e10) = &lt;bob.NOM chase some girl:-v = chase &amp; int(x_-7) &amp; ext(bob), {&lt;bob.NOM::-k = bob, {}&gt;, &lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;
e12 = &lt;-s::+v +k -t = present, {}&gt;
e13 = insert(e11, e12) = &lt;-s::+v +k -t = present, {&lt;bob.NOM chase some girl:-v = chase &amp; int(x_-7) &amp; ext(bob), {&lt;bob.NOM::-k = bob, {}&gt;, &lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;}&gt;
e14 = merge_comp(e13) = &lt;-s:+k -t = present, bob.NOM chase some girl v = chase &amp; int(x_-7) &amp; ext(bob), {&lt;bob.NOM::-k = bob, {}&gt;, &lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;
e15 = merge_spec(e14) = &lt;-s:-t = present, _ k = bob, bob.NOM chase some girl v = chase &amp; int(x_-7) &amp; ext(bob), {&lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;
e16 = spellout(e15) = &lt;_ -s bob.NOM chase some girl:-t = &lt;present &amp; chase &amp; int(x_-7) &amp; ext(bob)&gt;, {&lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;
e17 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e18 = insert(e16, e17) = &lt;&#949;.Q::+t +q -c = , {&lt;_ -s bob.NOM chase some girl:-t = &lt;present &amp; chase &amp; int(x_-7) &amp; ext(bob)&gt;, {&lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;}&gt;
e19 = merge_comp(e18) = &lt;&#949;.Q:+q -c = , _ -s bob.NOM chase some girl t = &lt;present &amp; chase &amp; int(x_-7) &amp; ext(bob)&gt;, {&lt;some girl:-q = some &amp; int_-7(girl), {}&gt;}&gt;
e20 = merge_spec(e19) = &lt;&#949;.Q:-c = , _ q = some &amp; int_-7(girl), _ -s bob.NOM chase some girl t = &lt;present &amp; chase &amp; int(x_-7) &amp; ext(bob)&gt;, {}&gt;
e21 = spellout(e20) = &lt;_ -s bob.NOM chase some girl:-c = some &amp; int_-7(girl) &amp; &lt;present &amp; chase &amp; int(x_-7) &amp; ext(bob)&gt;, {}&gt;
some &amp; int_-7(girl) &amp; &lt;present &amp; chase &amp; int(x_-7) &amp; ext(bob)&gt;
False
PASS

&#949;.Q bob.NOM chase -s every girl
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;every::+n -d -q = every, {}&gt;
e2 = insert(e0, e1) = &lt;every::+n -d -q = every, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;every:-d -q = every, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;every girl:-d -q = every &amp; int_-8(girl), {}&gt;
e5 = &lt;chase::+d +d -v = chase, {}&gt;
e6 = insert(e4, e5) = &lt;chase::+d +d -v = chase, {&lt;every girl:-d -q = every &amp; int_-8(girl), {}&gt;}&gt;
e7 = merge_nonfinal(e6) = &lt;chase:+d -v = chase, every girl d = x_-8, {&lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;
e8 = &lt;bob.NOM::-d -k = bob, {}&gt;
e9 = insert(e7, e8) = &lt;chase:+d -v = chase, every girl d = x_-8, {&lt;bob.NOM::-d -k = bob, {}&gt;, &lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;
e10 = merge_nonfinal(e9) = &lt;chase:-v = chase, bob.NOM d = bob, every girl d = x_-8, {&lt;bob.NOM::-k = bob, {}&gt;, &lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;
e11 = spellout(e10) = &lt;bob.NOM chase every girl:-v = chase &amp; int(x_-8) &amp; ext(bob), {&lt;bob.NOM::-k = bob, {}&gt;, &lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;
e12 = &lt;-s::+v +k -t = present, {}&gt;
e13 = insert(e11, e12) = &lt;-s::+v +k -t = present, {&lt;bob.NOM chase every girl:-v = chase &amp; int(x_-8) &amp; ext(bob), {&lt;bob.NOM::-k = bob, {}&gt;, &lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;}&gt;
e14 = merge_comp(e13) = &lt;-s:+k -t = present, bob.NOM chase every girl v = chase &amp; int(x_-8) &amp; ext(bob), {&lt;bob.NOM::-k = bob, {}&gt;, &lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;
e15 = merge_spec(e14) = &lt;-s:-t = present, _ k = bob, bob.NOM chase every girl v = chase &amp; int(x_-8) &amp; ext(bob), {&lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;
e16 = spellout(e15) = &lt;_ -s bob.NOM chase every girl:-t = &lt;present &amp; chase &amp; int(x_-8) &amp; ext(bob)&gt;, {&lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;
e17 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e18 = insert(e16, e17) = &lt;&#949;.Q::+t +q -c = , {&lt;_ -s bob.NOM chase every girl:-t = &lt;present &amp; chase &amp; int(x_-8) &amp; ext(bob)&gt;, {&lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;}&gt;
e19 = merge_comp(e18) = &lt;&#949;.Q:+q -c = , _ -s bob.NOM chase every girl t = &lt;present &amp; chase &amp; int(x_-8) &amp; ext(bob)&gt;, {&lt;every girl:-q = every &amp; int_-8(girl), {}&gt;}&gt;
e20 = merge_spec(e19) = &lt;&#949;.Q:-c = , _ q = every &amp; int_-8(girl), _ -s bob.NOM chase every girl t = &lt;present &amp; chase &amp; int(x_-8) &amp; ext(bob)&gt;, {}&gt;
e21 = spellout(e20) = &lt;_ -s bob.NOM chase every girl:-c = every &amp; int_-8(girl) &amp; &lt;present &amp; chase &amp; int(x_-8) &amp; ext(bob)&gt;, {}&gt;
every &amp; int_-8(girl) &amp; &lt;present &amp; chase &amp; int(x_-8) &amp; ext(bob)&gt;
False
PASS

&#949;.Q some.NOM girl chase -s alice
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;some.NOM::+n -d -k -q = some, {}&gt;
e2 = insert(e0, e1) = &lt;some.NOM::+n -d -k -q = some, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;some.NOM:-d -k -q = some, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;some.NOM girl:-d -k -q = some &amp; int_-9(girl), {}&gt;
e5 = &lt;chase::+d +d -v = chase, {}&gt;
e6 = &lt;alice::-d = alice, {}&gt;
e7 = insert(e5, e6) = &lt;chase::+d +d -v = chase, {&lt;alice::-d = alice, {}&gt;}&gt;
e8 = merge_comp(e7) = &lt;chase:+d -v = chase, alice d = alice, {}&gt;
e9 = insert(e4, e8) = &lt;chase:+d -v = chase, alice d = alice, {&lt;some.NOM girl:-d -k -q = some &amp; int_-9(girl), {}&gt;}&gt;
e10 = merge_nonfinal(e9) = &lt;chase:-v = chase, some.NOM girl d = x_-9, alice d = alice, {&lt;some.NOM girl:-k -q = some &amp; int_-9(girl), {}&gt;}&gt;
e11 = spellout(e10) = &lt;some.NOM girl chase alice:-v = chase &amp; int(alice) &amp; ext(x_-9), {&lt;some.NOM girl:-k -q = some &amp; int_-9(girl), {}&gt;}&gt;
e12 = &lt;-s::+v +k -t = present, {}&gt;
e13 = insert(e11, e12) = &lt;-s::+v +k -t = present, {&lt;some.NOM girl chase alice:-v = chase &amp; int(alice) &amp; ext(x_-9), {&lt;some.NOM girl:-k -q = some &amp; int_-9(girl), {}&gt;}&gt;}&gt;
e14 = merge_comp(e13) = &lt;-s:+k -t = present, some.NOM girl chase alice v = chase &amp; int(alice) &amp; ext(x_-9), {&lt;some.NOM girl:-k -q = some &amp; int_-9(girl), {}&gt;}&gt;
e15 = merge_nonfinal(e14) = &lt;-s:-t = present, some.NOM girl k = x_-9, some.NOM girl chase alice v = chase &amp; int(alice) &amp; ext(x_-9), {&lt;some.NOM girl:-q = some &amp; int_-9(girl), {}&gt;}&gt;
e16 = spellout(e15) = &lt;some.NOM girl -s some.NOM girl chase alice:-t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-9)&gt;, {&lt;some.NOM girl:-q = some &amp; int_-9(girl), {}&gt;}&gt;
e17 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e18 = insert(e16, e17) = &lt;&#949;.Q::+t +q -c = , {&lt;some.NOM girl -s some.NOM girl chase alice:-t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-9)&gt;, {&lt;some.NOM girl:-q = some &amp; int_-9(girl), {}&gt;}&gt;}&gt;
e19 = merge_comp(e18) = &lt;&#949;.Q:+q -c = , some.NOM girl -s some.NOM girl chase alice t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-9)&gt;, {&lt;some.NOM girl:-q = some &amp; int_-9(girl), {}&gt;}&gt;
e20 = merge_spec(e19) = &lt;&#949;.Q:-c = , _ q = some &amp; int_-9(girl), some.NOM girl -s some.NOM girl chase alice t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-9)&gt;, {}&gt;
e21 = spellout(e20) = &lt;some.NOM girl -s some.NOM girl chase alice:-c = some &amp; int_-9(girl) &amp; &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-9)&gt;, {}&gt;
some &amp; int_-9(girl) &amp; &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-9)&gt;
False
PASS

&#949;.Q every.NOM girl chase -s alice
e0 = &lt;girl::-n = girl, {}&gt;
e1 = &lt;every.NOM::+n -d -k -q = every, {}&gt;
e2 = insert(e0, e1) = &lt;every.NOM::+n -d -k -q = every, {&lt;girl::-n = girl, {}&gt;}&gt;
e3 = merge_comp(e2) = &lt;every.NOM:-d -k -q = every, girl n = girl, {}&gt;
e4 = spellout(e3) = &lt;every.NOM girl:-d -k -q = every &amp; int_-10(girl), {}&gt;
e5 = &lt;chase::+d +d -v = chase, {}&gt;
e6 = &lt;alice::-d = alice, {}&gt;
e7 = insert(e5, e6) = &lt;chase::+d +d -v = chase, {&lt;alice::-d = alice, {}&gt;}&gt;
e8 = merge_comp(e7) = &lt;chase:+d -v = chase, alice d = alice, {}&gt;
e9 = insert(e4, e8) = &lt;chase:+d -v = chase, alice d = alice, {&lt;every.NOM girl:-d -k -q = every &amp; int_-10(girl), {}&gt;}&gt;
e10 = merge_nonfinal(e9) = &lt;chase:-v = chase, every.NOM girl d = x_-10, alice d = alice, {&lt;every.NOM girl:-k -q = every &amp; int_-10(girl), {}&gt;}&gt;
e11 = spellout(e10) = &lt;every.NOM girl chase alice:-v = chase &amp; int(alice) &amp; ext(x_-10), {&lt;every.NOM girl:-k -q = every &amp; int_-10(girl), {}&gt;}&gt;
e12 = &lt;-s::+v +k -t = present, {}&gt;
e13 = insert(e11, e12) = &lt;-s::+v +k -t = present, {&lt;every.NOM girl chase alice:-v = chase &amp; int(alice) &amp; ext(x_-10), {&lt;every.NOM girl:-k -q = every &amp; int_-10(girl), {}&gt;}&gt;}&gt;
e14 = merge_comp(e13) = &lt;-s:+k -t = present, every.NOM girl chase alice v = chase &amp; int(alice) &amp; ext(x_-10), {&lt;every.NOM girl:-k -q = every &amp; int_-10(girl), {}&gt;}&gt;
e15 = merge_nonfinal(e14) = &lt;-s:-t = present, every.NOM girl k = x_-10, every.NOM girl chase alice v = chase &amp; int(alice) &amp; ext(x_-10), {&lt;every.NOM girl:-q = every &amp; int_-10(girl), {}&gt;}&gt;
e16 = spellout(e15) = &lt;every.NOM girl -s every.NOM girl chase alice:-t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-10)&gt;, {&lt;every.NOM girl:-q = every &amp; int_-10(girl), {}&gt;}&gt;
e17 = &lt;&#949;.Q::+t +q -c = , {}&gt;
e18 = insert(e16, e17) = &lt;&#949;.Q::+t +q -c = , {&lt;every.NOM girl -s every.NOM girl chase alice:-t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-10)&gt;, {&lt;every.NOM girl:-q = every &amp; int_-10(girl), {}&gt;}&gt;}&gt;
e19 = merge_comp(e18) = &lt;&#949;.Q:+q -c = , every.NOM girl -s every.NOM girl chase alice t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-10)&gt;, {&lt;every.NOM girl:-q = every &amp; int_-10(girl), {}&gt;}&gt;
e20 = merge_spec(e19) = &lt;&#949;.Q:-c = , _ q = every &amp; int_-10(girl), every.NOM girl -s every.NOM girl chase alice t = &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-10)&gt;, {}&gt;
e21 = spellout(e20) = &lt;every.NOM girl -s every.NOM girl chase alice:-c = every &amp; int_-10(girl) &amp; &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-10)&gt;, {}&gt;
every &amp; int_-10(girl) &amp; &lt;present &amp; chase &amp; int(alice) &amp; ext(x_-10)&gt;
False
PASS
</pre>
</div>
</div>
</section>

<section id="outline-container-org24105a7" class="outline-2">
<h2 id="org24105a7"><span class="section-number-2">5</span> Bibliography</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>Meaghan Fowlie. Parsing adjuncts. Online, 2015. Retrieved from <a href="http://meaghanfowlie.com/documents/fowlie_mit_slides.pdf">http://meaghanfowlie.com/documents/fowlie_mit_slides.pdf</a>.</li>
<li>Hendrik Harkema. <i>Parsing Minimalist Languages</i>. PhD thesis, University of California, Los Angeles, 2001.</li>
<li>Tim Hunter. Insertion minimalist grammars: Eliminating redundancies between merge and move. In M. Kanazawa, A. Kornai, M. Kracht, and H. Seki, editors, <i>The Mathematics of Language</i>, page 90â€“107. Springer, Berlin, Heidelberg, 2011.</li>
<li>Tim Hunter. <i>Syntactic Effects of Conjunctivist Semantics</i>. John Benjamins Publishing Company, 2011.</li>
<li>Gregory M Kobele. <i>Generating Copies: An investigation into structural identity in language and grammar</i>. PhD thesis, University of California, Los Angeles, 2006.</li>
<li>Patrick Niedzielski. fowlie-mga: An implementation of meaghan fowlieâ€™s minimalist grammar with adjunction (mga) formalism in haskell. Online, 2015. Retrieved from <a href="https://github.com/pniedzielski/fowlie-mga/">https://github.com/pniedzielski/fowlie-mga/</a>.</li>
<li>Barbara H. Partee. Montague grammar. In Neil J. Smelser and Paul B. Baltes, editors, <i>International Encyclopedia of the Social and Behavioral Sciences</i>. Oxford: Pergamon/Elsevier Science, 2001. Retrieved from <a href="http://people.umass.edu/partee/docs/MontagueGrammarElsevier.PDF">http://people.umass.edu/partee/docs/MontagueGrammarElsevier.PDF</a>.</li>
<li>MiloÅ¡ StanojevicÌ. <i>Minimalist Grammar Transition-Based Parsing</i>, pages 273â€“290. Springer Berlin Heidelberg, Berlin, Heidelberg, 2016.</li>
</ul>
</div>
</section>

<section id="outline-container-org90a68a5" class="outline-2">
<h2 id="org90a68a5"><span class="section-number-2">6</span> License</h2>
<div class="outline-text-2" id="text-6">
<p>
This file is licensed under the GNU GPLv3. See the original source file <code>mg.org</code> for details.
</p>
</div>
</section>
</article>
<footer id="postamble" class="status">
<p class="author">Author: David Li</p>
<p class="date">Created: 2017-05-09 Tue 13:52</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</footer>
</body>
</html>
